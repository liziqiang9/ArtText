/*! ArtText v0.1.1 */!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=10)}([function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(2),o=n.n(r),i=n(6),s={insert:"head",singleton:!1},a=(o()(i.a,s),i.a.locals,function(){function e(e){this.artText=e}return e.loadScript=function(e,t){var n=document.createElement("script");n.type="text/javascript",void 0!==t&&(n.onload=function(){t()}),n.src=e,document.body.appendChild(n)},e.loadCss=function(e){var t=document.getElementsByTagName("head")[0],n=document.createElement("link");n.rel="stylesheet",n.type="text/css",n.href=e,t.appendChild(n)},e.addCss=function(e){if(null==e||""==e)return!1;var t=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");return n.type="text/css",n.appendChild(document.createTextNode(e)),t.appendChild(n),!0},e.hasClass=function(e,t){return(" "+e.className+" ").indexOf(" "+t+" ")>-1},e.insertAfter=function(e,t,n){e.lastChild==n?e.appendChild(t):e.insertBefore(t,n.previousElementSibling)},e.prototype.add=function(e){if(Array.isArray(e))for(var t=0,n=e;t<n.length;t++){var r=n[t],o=r.dom,i=r.place;this.insertDom(o,i)}else{o=e.dom,i=e.place;this.insertDom(o,i)}},e.prototype.insertDom=function(t,n){switch(n){case"Editor.before":this.artText.dom.insertBefore(t,this.artText.get("$editor").dom);break;case"Editor.after":e.insertAfter(this.artText.dom,t,this.artText.get("$editor").dom);break;default:this.artText.dom.appendChild(t)}},e}()),l=(t.b=a,{install:function(e,t){t.container.bind("$tool",a,[{get:"art"}],!0)},created:function(e,t){e.get("$tool")}})},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return s}));var r=n(0),o=function(){function e(){this.bindMap=new Map}return e.prototype.bind=function(e,t,n,r){void 0===r&&(r=!1),this.bindMap.set(e,{clazz:t,constructorArgs:n||[],renderFlag:r})},e.prototype.get=function(e,t){var n=this.bindMap.get(e),r=n.clazz,o=n.constructorArgs;if(n.renderFlag){for(var i=[],s=0,a=o;s<a.length;s++){var l=a[s];l.constructor===Object?"art"==l.get?i.push(t):i.push(t.get(l.get)):i.push(l)}return Reflect.construct(r,i)}return Reflect.construct(r,o)},e.prototype.has=function(e){return this.bindMap.has(e)},e}(),i=function(){function e(){}return e.use=function(t){t.install&&t.install(s,e.options),e.plugins.push(t)},e.createdArt=function(t){for(var n=0,r=e.plugins;n<r.length;n++){var o=r[n];o.created&&o.created(t,e.options)}},e.mountArt=function(t){for(var n=0,r=e.plugins;n<r.length;n++){var o=r[n];o.mount&&o.mount(t,e.options)}},e.unmountArt=function(t){for(var n=0,r=e.plugins;n<r.length;n++){var o=r[n];o.unmount&&o.unmount(t,e.options)}},e.plugins=[],e.container=new o,e.options={container:e.container,Tool:r.b},e}(),s=function(){function e(){}return e.prototype.get=function(e){return null==this[e]&&(this[e]=i.container.get(e,this)),this[e]},e.prototype.set=function(e,t){null==this[e]&&i.container.has(e)&&(this[e]=i.container.get(e,this)),this[e]=t},e}()},function(e,t,n){"use strict";var r,o=function(){return void 0===r&&(r=Boolean(window&&document&&document.all&&!window.atob)),r},i=function(){var e={};return function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}e[t]=n}return e[t]}}(),s=[];function a(e){for(var t=-1,n=0;n<s.length;n++)if(s[n].identifier===e){t=n;break}return t}function l(e,t){for(var n={},r=[],o=0;o<e.length;o++){var i=e[o],l=t.base?i[0]+t.base:i[0],d=n[l]||0,c="".concat(l," ").concat(d);n[l]=d+1;var h=a(c),u={css:i[1],media:i[2],sourceMap:i[3]};-1!==h?(s[h].references++,s[h].updater(u)):s.push({identifier:c,updater:g(u,t),references:1}),r.push(c)}return r}function d(e){var t=document.createElement("style"),r=e.attributes||{};if(void 0===r.nonce){var o=n.nc;o&&(r.nonce=o)}if(Object.keys(r).forEach((function(e){t.setAttribute(e,r[e])})),"function"==typeof e.insert)e.insert(t);else{var s=i(e.insert||"head");if(!s)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");s.appendChild(t)}return t}var c,h=(c=[],function(e,t){return c[e]=t,c.filter(Boolean).join("\n")});function u(e,t,n,r){var o=n?"":r.media?"@media ".concat(r.media," {").concat(r.css,"}"):r.css;if(e.styleSheet)e.styleSheet.cssText=h(t,o);else{var i=document.createTextNode(o),s=e.childNodes;s[t]&&e.removeChild(s[t]),s.length?e.insertBefore(i,s[t]):e.appendChild(i)}}function p(e,t,n){var r=n.css,o=n.media,i=n.sourceMap;if(o?e.setAttribute("media",o):e.removeAttribute("media"),i&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),e.styleSheet)e.styleSheet.cssText=r;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(r))}}var f=null,m=0;function g(e,t){var n,r,o;if(t.singleton){var i=m++;n=f||(f=d(t)),r=u.bind(null,n,i,!1),o=u.bind(null,n,i,!0)}else n=d(t),r=p.bind(null,n,t),o=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)};return r(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;r(e=t)}else o()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=o());var n=l(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var r=0;r<n.length;r++){var o=a(n[r]);s[o].references--}for(var i=l(e,t),d=0;d<n.length;d++){var c=a(n[d]);0===s[c].references&&(s[c].updater(),s.splice(c,1))}n=i}}}},function(e,t,n){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=e(t);return t[2]?"@media ".concat(t[2]," {").concat(n,"}"):n})).join("")},t.i=function(e,n,r){"string"==typeof e&&(e=[[null,e,""]]);var o={};if(r)for(var i=0;i<this.length;i++){var s=this[i][0];null!=s&&(o[s]=!0)}for(var a=0;a<e.length;a++){var l=[].concat(e[a]);r&&o[l[0]]||(n&&(l[2]?l[2]="".concat(n," and ").concat(l[2]):l[2]=n),t.push(l))}},t}},function(e,t,n){"use strict";var r,o;n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a})),function(e){e.editor="editor",e.read="read",e.read_noStyle="read-noStyle"}(r||(r={})),function(e){e.strict="strict",e.loose="loose"}(o||(o={}));var i={defaultMd:"",markdown:"",fileInfo:{},runModel:r.editor,securityLevel:o.strict,math:{name:"katex",js:"https://cdn.jsdelivr.net/npm/katex@0.10.1/dist/katex.min.js",css:"https://cdn.jsdelivr.net/npm/katex@0.10.1/dist/katex.min.css",jsFun:null},code:{name:"hljs",js:"https://libs.cdnjs.net/highlight.js/10.1.2/highlight.min.js",css:null,jsFun:null},flowchart:{name:"flowchart",js:["https://cdnjs.cloudflare.com/ajax/libs/raphael/2.3.0/raphael.min.js","https://cdnjs.cloudflare.com/ajax/libs/flowchart/1.14.0/flowchart.min.js"],css:null,jsFun:null}},s={backgroundColor:"#fff",color:"#1abc9c"},a=function(){function e(){}return e.theme=s,e}()},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return l}));var r,o=n(4),i=n(1),s=(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),a=function(t){function n(e){void 0===e&&(e={});var n=t.call(this)||this;return n.dom=document.createElement("div"),n.dom.setAttribute("class","art-main"),n.options=Object.assign({},o.a,e),i.b.createdArt(n),n}return s(n,t),n.prototype.mount=function(e){return this.rootContainer=document.querySelector(e),this.rootContainer.appendChild(this.dom),i.b.mountArt(this),this},n.prototype.exportAPI=function(e,t){this[e]=t},n.prototype.unmount=function(){i.b.unmountArt(this)},n.version=void 0===e.env.ART_VERSION?"dev":e.env.ART_VERSION,n.use=i.b.use,n}(i.a);t.b=a;var l={install:function(e,t){window.ArtText=a}}}).call(this,n(9))},function(e,t,n){"use strict";var r=n(3),o=n.n(r)()((function(e){return e[1]}));o.push([e.i,".art-floatTool {\r\n    width: 180px;\r\n    list-style: none;\r\n    position: fixed;\r\n    top: 10px;\r\n    left: 10px;\r\n    box-shadow: rgba(0, 0, 0, 0.1) 0px 2px 12px 0px;\r\n    background: #fff;\r\n    font-size: 14px;\r\n    padding: 8px 0 6px\r\n}\r\n\r\n.art-floatTool-li {\r\n    padding: 6px 25px;\r\n    cursor: pointer;\r\n}\r\n\r\n.art-floatTool li:hover {\r\n    background-color: #f4f4f4;\r\n    color: #1abc9c;\r\n}\r\n\r\n.art-divider {\r\n    margin: 4px 0;\r\n    background: #e5e5e5;\r\n    padding: 1px 0 0;\r\n}",""]),t.a=o},function(e,t,n){"use strict";var r=n(3),o=n.n(r)()((function(e){return e[1]}));o.push([e.i,".art-editor {\r\n    box-shadow: 0 2px 12px 0 rgba(0, 0, 0, 0.1);\r\n    padding: 30px 25px;\r\n    border-radius: 4px;\r\n    background-color: #fff;\r\n}",""]),t.a=o},function(e,t,n){"use strict";var r=n(3),o=n.n(r)()((function(e){return e[1]}));o.push([e.i,'.art-render-art {\r\n    outline: none;\r\n    white-space: pre-wrap;\r\n    word-break: break-all\r\n}\r\n\r\n.art-hide {\r\n    display: inline-block;\r\n    width: 0;\r\n    height: 0;\r\n    overflow: hidden;\r\n    vertical-align: middle;\r\n}\r\n\r\n.art-show {\r\n    color: #ccc;\r\n}\r\n\r\n.art-show-math {\r\n    z-index: 5;\r\n    position: absolute;\r\n    padding: 13px 25px;\r\n    background: #fff;\r\n    box-shadow: rgba(0, 0, 0, 0.1) 0px 2px 12px 0px;\r\n}\r\n.art-editor li>p>input {\r\n    position: absolute;\r\n    margin-left: -1.15em;\r\n    margin-top: 0.45em;\r\n}\r\n\r\n.art-buttonTool-hover {\r\n    font-size: 13px;\r\n    font-weight: 600;\r\n    margin-left: 4px;\r\n    cursor: pointer;\r\n    border: none;\r\n    outline: none;\r\n    padding: 0px 4px;\r\n    border: 1px solid #9a9a9a00;\r\n    background: #fff;\r\n}\r\n\r\n.art-buttonTool-hover:hover {\r\n    border-color: #aaaa;\r\n    background: #efefef;\r\n}\r\n\r\n.art-flowTool {\r\n    width: 100%;\r\n    text-align: center;\r\n}\r\n\r\n.art-codeTool {\r\n    width: 100%;\r\n    font-weight: 600;\r\n    visibility: visible;\r\n    display: flex;\r\n}\r\n\r\n.art-toc {\r\n    padding: 6px 15px;\r\n    margin: 0 0 15px;\r\n    font-weight: 400;\r\n    border: 1px dashed #9990;\r\n}\r\n\r\n.art-toc p {\r\n    margin-bottom: 2px\r\n}\r\n\r\n.art-toc a {\r\n    border-bottom: none;\r\n    color: #4183c4\r\n}\r\n\r\n.art-toc-h2 {\r\n    margin-left: 2em\r\n}\r\n\r\n.art-toc-h3 {\r\n    margin-left: 4em\r\n}\r\n\r\n.art-toc-h4 {\r\n    margin-left: 6em\r\n}\r\n\r\n.art-toc-h5 {\r\n    margin-left: 8em\r\n}\r\n\r\n.art-toc-h6 {\r\n    margin-left: 10em\r\n}\r\n\r\n.art-tocTool {\r\n    width: 100%;\r\n    position: relative;\r\n}\r\n\r\n.markdown-body h1::before,\r\n.markdown-body h2::before,\r\n.markdown-body h3::before,\r\n.markdown-body h4::before,\r\n.markdown-body h5::before,\r\n.markdown-body h6::before {\r\n    position: absolute;\r\n    color: rgba(88, 96, 105, 0.36);\r\n    font-weight: 400;\r\n    font-size: 10px;\r\n    margin-left: -2em;\r\n    margin-top: 0.em;\r\n}\r\n\r\n.markdown-body h1::before {\r\n    content: "H1";\r\n}\r\n\r\n.markdown-body h2::before {\r\n    content: "H2";\r\n}\r\n\r\n.markdown-body h3::before {\r\n    content: "H3";\r\n}\r\n\r\n.markdown-body h4::before {\r\n    content: "H4";\r\n}\r\n\r\n.markdown-body h5::before {\r\n    content: "H5";\r\n}\r\n\r\n.markdown-body h6::before {\r\n    content: "H6";\r\n}',""]),t.a=o},function(e,t){var n,r,o=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(e){if(n===setTimeout)return setTimeout(e,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:i}catch(e){n=i}try{r="function"==typeof clearTimeout?clearTimeout:s}catch(e){r=s}}();var l,d=[],c=!1,h=-1;function u(){c&&l&&(c=!1,l.length?d=l.concat(d):h=-1,d.length&&p())}function p(){if(!c){var e=a(u);c=!0;for(var t=d.length;t;){for(l=d,d=[];++h<t;)l&&l[h].run();h=-1,t=d.length}l=null,c=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function m(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];d.push(new f(e,t)),1!==d.length||c||a(p)},f.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=m,o.addListener=m,o.once=m,o.off=m,o.removeListener=m,o.removeAllListeners=m,o.emit=m,o.prependListener=m,o.prependOnceListener=m,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(e,t,n){"use strict";n.r(t);var r=n(5),o=n(1),i=n(0),s=n(2),a=n.n(s),l=n(7),d={insert:"head",singleton:!1},c=(a()(l.a,d),l.a.locals,function(){function e(e){this.artText=e,this.dom=document.createElement("div"),this.dom.setAttribute("class","art-editor markdown-body"),this.artText.dom.appendChild(this.dom),this.fileInfo={},this.renders={},this.artText.exportAPI("openFile",this.getFile)}return e.prototype.init=function(){this.defaultRender&&(this.runRender=this.defaultRender),this.runRender.open(),this.runRender.setMd(this.artText.options.defaultMd)},e.prototype.addRender=function(e,t){this.renders[e]=t,this.dom.appendChild(t.createDom()),this.artText.get("$eventCenter").waitOnceEmit("@switchRenderButton-addRender",this.renders[e].abbrName,e)},e.prototype.openFile=function(e,t){void 0===e&&(e={}),void 0===t&&(t=null),this.fileInfo=Object.assign({name:null,id:null,defaultMd:""},e),this.switchRender(t)},e.prototype.getFile=function(e){return void 0===e&&(e=null),"fileInfo"==e?this.fileInfo:"md"==e?this.runRender.getMd():(this.fileInfo.markdown=this.runRender.getMd(),this.fileInfo)},e.prototype.switchRender=function(e){var t,n=null;if(null==e)n=this.defaultRender,t=this.fileInfo.defaultMd;else{if(this.runRender==this.renders[e])return null;n=this.renders[e],t=this.runRender.getMd()}this.runRender.close(),n.open(),n.setMd(t),this.runRender=n},e}()),h={install:function(e,t){t.container.bind("$editor",c,[{get:"art"}],!0)},created:function(e,t){e.get("$editor")},mount:function(e,t){e.get("$editor").init()}},u=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],s=0,a=i.length;s<a;s++,o++)r[o]=i[s];return r},p=function(){function e(e){this.artText=e,this.events=new Map,this.waitEvents=new Map,this.listeners={},this.domID=0;var t=this;this.attachDOMEvent(this.artText.dom,"art-event",(function(e){return t.artEvent(e)}))}return e.prototype.artEvent=function(e){this.emit(e.detail.type,e.detail)},Object.defineProperty(e.prototype,"eventId",{get:function(){return"eventId-"+this.domID++},enumerable:!1,configurable:!0}),e.prototype.attachDOMEvent=function(e,t,n,r){if(void 0===r&&(r=!1),this.checkHasBind(e,t,n,r))return null;var o=this.eventId;return e.addEventListener(t,n,r),this.events.set(o,{target:e,type:t,listener:n,options:r}),o},e.prototype.detachDOMEvent=function(e){if(!e)return!1;var t=this.events.get(e);if(null!=t){var n=t.target,r=t.type,o=t.listener,i=t.options;n.removeEventListener(r,o,i),this.events.delete(e)}return!0},e.prototype.detachAllDomEvent=function(){for(var e in this.events)this.detachDOMEvent(e)},e.prototype.checkHasBind=function(e,t,n,r){for(var o in void 0===r&&(r=!1),this.events){var i=this.events[o],s=i.target,a=i.type,l=i.listener,d=i.options;if(s===e&&a===t&&l===n&&d===r)return!0}return!1},e.prototype.subscribe=function(e,t,n){void 0===n&&(n=!1);var r=this.listeners[e],o={listener:t,once:n};r&&Array.isArray(r)?r.push(o):this.listeners[e]=[o],this.waitEvents.has(e)&&(this.emit.apply(this,u([e],this.waitEvents.get(e))),this.waitEvents.delete(e))},e.prototype.on=function(e,t){this.subscribe(e,t)},e.prototype.once=function(e,t){this.subscribe(e,t,!0)},e.prototype.emit=function(e){for(var t=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var o=this.listeners[e];return!(!o||!Array.isArray(o))&&(o.forEach((function(r){var o=r.listener,i=r.once;o.apply(void 0,n),i&&t.off(e,o)})),!0)},e.prototype.waitOnceEmit=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];this.emit.apply(this,u([e],t))||this.waitEvents.set(e,t)},e.prototype.off=function(e,t){var n,r=this.listeners[e];Array.isArray(r)&&-1!=(n=r.findIndex((function(e){return e.listener===t})))&&r.splice(n,1)},e}(),f={install:function(e,t){t.container.bind("$eventCenter",p,[{get:"art"}],!0)},created:function(e,t){e.get("$eventCenter")}},m={created:function(e,t){e.get("toolbar").add({title:"导出",click:function(){var t=e.get("$editor").getFile(),n="arttext";t.name&&(n=t.name);var r=document.createElement("a");r.download=n+".md",r.style.display="none";var o=new Blob([t.markdown]);r.href=URL.createObjectURL(o),document.body.appendChild(r),r.click(),document.body.removeChild(r)}})}},g={created:function(e,t){e.get("toolbar").add({title:"导入",click:function(){var t=document.createElement("input");t.type="file",t.accept=".md",t.style.display="none",document.body.appendChild(t),t.click(),t.onchange=function(){var n=new FileReader;n.onload=function(){e.get("$editor").openFile({name:t.files[0].name.replace(/.md$/,""),defaultMd:n.result.toString()})},n.readAsText(t.files[0],"utf8")},document.body.removeChild(t)}})}},b={created:function(e,t){e.get("toolbar").add({title:"新建",click:function(){return e.get("$editor").openFile()}})}},v={created:function(e,t){e.get("toolbar").add({title:'<span title="项目地址">Github</span>',click:function(){return window.open("https://github.com/liziqiang9/ArtText")}})}},y=function(){function e(e){this.artText=e,this.title="默认",this.spanElement=null,this.abbrNames=[],this.renderNames=[];var t=this;this.artText.get("$eventCenter").on("@switchRenderButton-addRender",(function(e,n){t.addRender(e,n)}))}return e.prototype.addRender=function(e,t){this.abbrNames.push(e),this.renderNames.push(t)},e.prototype.click=function(){var e=this.abbrNames.indexOf(this.title);if(e>-1){++e==this.abbrNames.length&&(e=0),this.title=this.abbrNames[e],this.spanElement.innerHTML=this.abbrNames[e];try{this.artText.get("$editor").switchRender(this.renderNames[e])}catch(e){console.error(e),this.artText.get("message").create("切换渲染器失败","error")}}},e}(),N={install:function(e,t){t.container.bind("switchRenderButton",y,[{get:"art"}],!0)},created:function(e,t){var n=e.get("switchRenderButton");n.abbrNames.length>0&&(n.title=n.abbrNames[0]),n.spanElement=e.get("toolbar").add({title:n.title,click:function(){return n.click()}})}},w=function(){function e(e){this.artText=e,this.dom=document.createElement("div"),this.dom.setAttribute("class","art-toolbar-min");var t=this.dom;this.dom.onmouseover=function(){for(var e=1;e<t.childNodes.length;e++)t.childNodes[e].style.display="inherit"},this.dom.onmouseout=function(){for(var e=1;e<t.childNodes.length;e++)t.childNodes[e].style.display="none"},this.artText.get("$tool").add([{dom:this.dom,place:"Editor.before"}])}return e.prototype.add=function(e){return null==e.level&&(e.level=0),this.addBotton(e.title,(function(){return e.click()}),e.level)},e.prototype.addBotton=function(e,t,n){void 0===n&&(n=0);var r=document.createElement("div");return r.setAttribute("class","art-toolbar-min-div"),0!=this.dom.childNodes.length&&(r.style.display="none"),r.innerHTML=e,r.addEventListener("click",t),this.dom.appendChild(r),r},e}(),x={install:function(e,t){o.b.use(N),o.b.use(b),o.b.use(g),o.b.use(m),o.b.use(v),t.container.bind("toolbar",w,[{get:"art"}],!0),t.Tool.addCss(".art-toolbar-min{width:80px;position: fixed;margin-left: 815px;font-weight:800;font-size:13.5px;text-align: center;background-color: #fff;box-shadow: 0 2px 12px 0 rgba(0, 0, 0, 0.1);border-radius: 3px;padding: 3px 0;color: #666;}.art-toolbar-min-div{padding:7px 16px;cursor:pointer;} .art-toolbar-min-div:hover{background-color: #f2f2f2;color: #1abc9c;}")},created:function(e,t){e.get("toolbar")}},C=n(4),T=function(){function e(e){this.dom=document.createElement("div"),this.dom.setAttribute("class","art-tool-message"),this.timer=null,e.get("$tool").add([{dom:this.dom}])}return e.prototype.create=function(e,t){void 0===t&&(t="null");var n=document.createElement("div");n.setAttribute("class","art-tool-message-body");var r=document.createElement("p");r.innerHTML=e,r.style.fontSize="13px",r.style.fontWeight="600",r.style.height="100%",r.style.margin="0",n.appendChild(r),"info"==t?(n.style.backgroundColor="#edf2fc",n.style.borderColor="#EBEEF5",n.style.color="#909399"):"success"==t?(n.style.backgroundColor="#f0f9eb",n.style.borderColor="#e1f3d8",n.style.color="#67C23A"):"warning"==t?(n.style.backgroundColor="#fdf6ec",n.style.borderColor="#faecd8",n.style.color="#E6A23C"):"error"==t?(n.style.backgroundColor="#fde2e2",n.style.borderColor="#e1f3d8",n.style.color="#F56C6C"):(n.style.backgroundColor=C.b.theme.backgroundColor,n.style.color=C.b.theme.color),this.addMessage(n)},e.prototype.addMessage=function(e){if(!this.timer){var t=this;this.timer=setTimeout((function(){t.delMessage()}),3e3)}e.style.top=(40+60*this.dom.childNodes.length).toString()+"px",this.dom.appendChild(e)},e.prototype.delMessage=function(){this.dom.removeChild(this.dom.childNodes[0]);for(var e=0;e<this.dom.childNodes.length;e++)this.dom.childNodes[e].style.top=(40+60*e).toString()+"px";if(this.dom.childNodes.length){var t=this;this.timer=setTimeout((function(){t.delMessage()}),3e3)}},e}(),A={install:function(e,t){t.container.bind("message",T,[{get:"art"}],!0),t.Tool.addCss(".art-tool-message-body{overflow:hidden;box-shadow: 0 2px 12px 0 rgba(0, 0, 0, 0.1);border-radius: 4px;left: 50%;margin: -27px 0 0 -170px;position: fixed;position: fixed !important;top: 40px;height: 40px;line-height: 40px;width: 340px;padding: 1px 10px 1px 15px;transition: opacity .3s,transform .4s,top .4s,-webkit-transform .4s;z-index: 1000;}")},created:function(e,t){e.get("message")}},E={created:function(e,t){e.get("toolbar").add({title:"历史",click:function(){return e.get("versionHistory").open()}})}},D={created:function(e,t){e.get("toolbar").add({title:"保存",click:function(){e.get("$eventCenter").emit("art-save");var t=e.get("$editor").getFile(),n=JSON.parse(localStorage.art_articles);if(t.id&&n.hasOwnProperty(t.id))localStorage[t.id]=t.markdown,n[t.id]=t,localStorage.art_articles=JSON.stringify(n),e.get("message").create("保存成功","success");else{var r=(new Date).getTime(),o="art_md_"+r+"_",i=o;t.name&&(o+=t.name,i=t.name),localStorage[o]=t.markdown,n[o]={ids:[o],time:r,name:i,id:o},localStorage.art_articles=JSON.stringify(n);var s=n[o];s.defaultMd=t.markdown,e.get("$editor").openFile(s),e.get("message").create("保存成功","success")}}})}},k=function(){function e(e){this.art=e,this.dom=document.createElement("div"),this.dom.setAttribute("class","art-VersionHistoryTool"),this.dom.style.display="none",this.maskLayer=document.createElement("div"),this.maskLayer.setAttribute("class","art-VersionHistoryTool-MaskLayer"),this.maskLayer.style.display="none",this.getRootDomChilds(),this.art.get("$tool").add([{dom:this.dom},{dom:this.maskLayer}])}return e.prototype.getRootDomChilds=function(){var e,t=document.createElement("span");t.style.position="absolute",t.style.right="-60px",t.style.padding="12px",t.style.cursor="pointer",t.style.color="#fff",t.innerHTML='<svg class="icon" style="width: 30px; height: 30px;vertical-align: middle;fill: currentColor;overflow: hidden;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1187"><path d="M557.252647 512l135.75794 135.75794c12.495592 12.495592 12.495592 32.757055 0 45.252647-12.495592 12.495592-32.757055 12.495592-45.252647 0L512 557.252647 376.24206 693.010587c-12.496615 12.496615-32.757055 12.495592-45.252647 0-12.495592-12.495592-12.496615-32.756031 0-45.252647l135.75794-135.75794L330.989413 376.24206c-12.496615-12.496615-12.495592-32.757055 0-45.252647 12.495592-12.495592 32.756031-12.496615 45.252647 0l135.75794 135.75794 135.75794-135.75794c12.495592-12.495592 32.756031-12.495592 45.252647 0 12.495592 12.495592 12.495592 32.757055 0 45.252647L557.252647 512z m-429.233972 0c0 212.062813 171.918511 383.981325 383.981325 383.981325s383.981325-171.918511 383.981325-383.981325S724.06179 128.018675 512 128.018675 128.018675 299.937187 128.018675 512z m-63.997569 0c0-247.406786 200.572108-447.978894 447.978894-447.978894S959.977871 264.593214 959.977871 512 759.405763 959.977871 512 959.977871 64.021106 759.405763 64.021106 512z" p-id="1188"></path></svg>',t.onclick=(e=this,function(){e.close()});var n=document.createElement("div");n.style.display="flex",n.style.width="210px",n.style.flexDirection="column",n.style.borderRight="1px solid #ebebeb";var r=document.createElement("div");r.style.padding="12px 20px",r.style.fontWeight="600",r.style.display="flex",r.innerHTML="历史版本";var o=document.createElement("div");o.style.display="flex",o.style.flexDirection="column",o.style.justifyContent="center",o.style.overflow="auto",this.sideDraftHistoryDirectory=document.createElement("div"),o.appendChild(this.sideDraftHistoryDirectory),this.sideDraftHistoryDirectory.style.overflow="auto",null!=localStorage.art_articles?this.art_articles=JSON.parse(localStorage.art_articles):(this.art_articles={},localStorage.art_articles=JSON.stringify(this.art_articles)),n.appendChild(r),n.appendChild(o);var i=document.createElement("div");i.style.flex="1 1",i.style.display="flex",i.style.flexDirection="column",i.style.overflow="auto",this.mainArticle=document.createElement("div"),this.mainArticle.style.flex="1 1",this.mainArticle.style.display="flex",this.mainArticle.style.overflow="auto",this.mainArticle.innerHTML='<textarea style="width: 100%;border: none;resize: none;outline: none;padding:13px 15px;font-size: 15px" readonly class="markdown-body">无打开</textarea>',this.mainFooter=document.createElement("div"),this.mainFooter.style.height="52px",this.mainFooter.style.display="flex",this.mainFooter.style.borderTop="1px solid #ebebeb",this.mainFooter.style.alignItems="center",this.mainFooter.style.padding="0 20px",this.footerDel=document.createElement("button"),this.footerDel.setAttribute("style","border-radius: 18px;margin-right: 20px;color:#e01a1a;border:none;padding: 7px;font-size: 13px;font-weight: 600;background: rgba(239, 26, 26, 0.08);cursor: pointer;"),this.footerDel.innerHTML='<svg class="icon" style="width: 17px; height: 17px;vertical-align: middle;fill: currentColor;overflow: hidden;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="689"><path d="M800.162002 316.659033c1.850138-17.575284 17.596773-30.322609 35.172058-28.473495 17.575284 1.850138 30.322609 17.596773 28.473494 35.172058l-57.966202 550.673811c-5.143137 48.856731-46.341445 85.946464-95.467306 85.946464H313.625954c-49.126884 0-90.325192-37.089733-95.468329-85.946464L160.192446 323.358619c-1.850138-17.575284 10.898211-33.32192 28.472471-35.172057 17.575284-1.850138 33.32192 10.898211 35.172058 28.473494l57.965179 550.672788c1.714038 16.285918 15.446807 28.64848 31.822776 28.648481h396.74707c16.375969 0 30.108738-12.363585 31.822776-28.648481l57.967226-550.673811z m-192.176904 99.345636c17.672498 0 31.998785 14.326287 31.998785 31.998785v223.989447c0 17.672498-14.326287 31.998785-31.998785 31.998785s-31.998785-14.326287-31.998785-31.998785V448.00243c0-17.671475 14.326287-31.997762 31.998785-31.997761z m-191.990662 0c17.672498 0 31.998785 14.326287 31.998785 31.998785v223.989447c0 17.672498-14.326287 31.998785-31.998785 31.998785s-31.998785-14.326287-31.998785-31.998785V448.00243c0-17.671475 14.326287-31.997762 31.998785-31.997761z m-31.998785-223.989447h255.987209v-47.998178c0-8.836249-7.163143-15.999392-15.999393-15.999392H399.995043c-8.836249 0-15.999392 7.163143-15.999392 15.999392v47.998178z m-63.996546 0V128.018675c0-35.344996 28.652574-63.996546 63.997569-63.996546h255.987209c35.343973 0 63.996546 28.652574 63.996546 63.996546v63.996547h223.99968c17.672498 0 31.998785 14.326287 31.998785 31.998785s-14.326287 31.998785-31.998785 31.998784H96.019891c-17.672498 0-31.998785-14.326287-31.998785-31.998784s14.326287-31.998785 31.998785-31.998785h223.979214z" p-id="690"></path></svg>',this.footerTag=document.createElement("button"),this.footerTag.setAttribute("style","border-radius: 18px;margin-right: 20px;color:#ebeb18;border:none;padding: 7px;font-size: 13px;font-weight: 600;background: rgba(229, 229, 109, 0.1);cursor: pointer;"),this.footerTag.innerHTML='<svg class="icon" style="width: 18px; height: 18px;vertical-align: middle;fill: currentColor;overflow: hidden;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2298"><path d="M512 64.021106c-11.816117 0-23.63121 6.791683-28.127617 20.375049l-97.82705 295.566646H93.719498c-27.710109 0-40.267099 34.785248-18.987446 52.612265L304.048831 624.711038l-82.039481 297.444413c-5.655813 20.513196 10.561543 37.82242 28.662806 37.82242 5.698792 0 11.585873-1.717108 17.030885-5.588275l244.296959-173.672458L756.301052 954.389596c5.445012 3.873214 11.335163 5.588275 17.030885 5.588275 18.10024 0 34.31862-17.310248 28.65462-37.82242L719.951169 624.712061l229.316779-192.135972c21.280676-17.827017 8.725732-52.612265-18.991539-52.612264H637.954667L540.127617 84.396155c-4.496407-13.583366-16.311501-20.37505-28.127617-20.375049z" p-id="2299"></path></svg>',this.footerRestore=document.createElement("button"),this.footerRestore.setAttribute("style","border-radius: 6px;flex: 1 1;color:#1aba9c;border:none;padding: 6px 15px;font-size: 13px;font-weight: 600;background: rgba(26, 186, 156, 0.08);cursor: pointer;"),this.footerRestore.innerHTML="恢复",this.mainFooter.appendChild(this.footerDel),this.mainFooter.appendChild(this.footerTag),this.mainFooter.appendChild(this.footerRestore),i.appendChild(this.mainArticle),i.appendChild(this.mainFooter),this.dom.appendChild(t),this.dom.appendChild(n),this.dom.appendChild(i)},e.prototype.open=function(){this.dom.style.display="flex",this.maskLayer.style.display="inline",this.art_articles=JSON.parse(localStorage.art_articles),document.body.style.overflow="hidden",this.mainArticle.childNodes[0].innerHTML="",this.updateDirectory()},e.prototype.updateDirectory=function(){this.sideDraftHistoryDirectory.innerHTML="";for(var e=this.art.get("$editor").getFile("fileInfo"),t=function(t){var r=document.createElement("div");r.style.height="60px",r.style.padding="10px 20px 0",r.style.cursor="pointer";var o=new Date(1*parseInt(n.art_articles[t].time)).toLocaleString().replace(/\//g,"-").substring(0,16),i=n.art_articles[t].name;if(e.id&&e.id==t){i="@当前草稿";for(var s=n.art_articles[t],a=localStorage[s.id],l=n.sideDraftHistoryDirectory.getElementsByClassName("art-VersionHistoryTool-selected"),d=l.length-1;d>=0;d--){var c=l[d].getAttribute("class");c=c.replace("art-VersionHistoryTool-selected",""),l[d].setAttribute("class",c)}r.setAttribute("class","art-VersionHistoryTool-selected"),n.mainArticle.childNodes[0].innerHTML=a,n.mainFooter.style.display="inherit";var h=n;n.footerDel.onclick=function(){localStorage.removeItem(s.ids[0]),delete h.art_articles[s.id],h.updateDirectory(),h.art.get("message").create(s.name+"已删除","success")},n.footerRestore.onclick=function(){h.art.get("$editor").openFile(a,s),h.art.get("message").create(s.name+"已恢复","success"),h.close()}}r.innerHTML='<div style="font-weight: 500;">'+o+'</div><div style="font-size: 12px;color: #555;">'+i+"</div>",r.onclick=n.restoreMdFile(n.art_articles[t]),n.sideDraftHistoryDirectory.appendChild(r)},n=this,r=0,o=Object.keys(this.art_articles).reverse();r<o.length;r++){t(o[r])}},e.prototype.restoreMdFile=function(e){var t=localStorage[e.id],n=this;return function(){for(var r=n.sideDraftHistoryDirectory.getElementsByClassName("art-VersionHistoryTool-selected"),o=r.length-1;o>=0;o--){var i=r[o].getAttribute("class");i=i.replace("art-VersionHistoryTool-selected",""),r[o].setAttribute("class",i)}this.setAttribute("class","art-VersionHistoryTool-selected"),n.mainArticle.childNodes[0].innerHTML=t,n.mainFooter.style.display="inherit",n.footerDel.onclick=function(){localStorage.removeItem(e.ids[0]),delete n.art_articles[e.id],n.updateDirectory(),n.art.get("message").create(e.name+"已删除","success")},n.footerRestore.onclick=function(){e.defaultMd=t,n.art.get("$editor").openFile(e),n.art.get("message").create(e.name+"已恢复","success"),n.close()}}},e.prototype.close=function(){localStorage.art_articles=JSON.stringify(this.art_articles),this.maskLayer.style.display="none",this.dom.style.display="none",document.body.style.overflow="auto"},e}(),M={install:function(e,t){o.b.use(E),o.b.use(D),t.container.bind("versionHistory",k,[{get:"art"}],!0),t.Tool.addCss(".art-VersionHistoryTool{position: fixed;z-index:10;width:60vw;right:20vw;height:92vh;top:4vh;background-color:#fff;box-shadow:0 2px 4px rgba(0, 0, 0, .12), 0 0 6px rgba(0, 0, 0, .04);border-radius: 2px}\n        .art-VersionHistoryTool-MaskLayer{position:fixed;top:0;right:0;bottom:0;left:0;background: rgba(26,26,26,.65);z-index:1}\n        .art-VersionHistoryTool-selected{color: #1aba9c}")},created:function(e,t){e.get("versionHistory")}},_=function(){function e(e){this.art=e,this.dom=document.createElement("div"),this.dom.setAttribute("class","art-sidebar"),this.openOrCloseFlag=!0,this.menuDom=document.createElement("div"),this.menuDom.setAttribute("class","art-sidebar-menu"),this.dom.appendChild(this.menuDom);var t=document.createElement("span");t.setAttribute("style","flex: 1"),this.menuDom.appendChild(t),this.mainDom=document.createElement("div"),this.mainDom.setAttribute("class","art-sidebar-main"),this.dom.appendChild(this.mainDom),this.selectMenuDom=null,this.info=new Map,this.art.get("$tool").add([{dom:this.dom,place:"Editor.before"}])}return e.prototype.add=function(e,t){this.info.set(e,t);var n=document.createElement("span");n.setAttribute("class","art-sidebar-menu-span"),n.innerHTML=e,this.menuDom.appendChild(n);var r=document.createElement("span");r.setAttribute("style","flex: 1"),this.menuDom.appendChild(r),t.style.display="none",this.mainDom.appendChild(t);var o=this;n.onclick=function(){o.openOption(this)},this.selectMenuDom||n.click()},e.prototype.openOption=function(e){this.selectMenuDom&&(this.selectMenuDom.classList.remove("art-sidebar-menu-select"),this.info.get(this.selectMenuDom.innerHTML).style.display="none"),this.selectMenuDom=e,e.classList.add("art-sidebar-menu-select"),this.info.get(this.selectMenuDom.innerHTML).style.display="inherit"},e.prototype.openOrClose=function(){this.openOrCloseFlag?this.dom.style.display="none":this.dom.style.display="inherit",this.openOrCloseFlag=!this.openOrCloseFlag},e}(),S={install:function(e,t){o.b.use(R),t.container.bind("sidebar",_,[{get:"art"}],!0),t.Tool.addCss(".art-sidebar{width:300px;margin-left: -333px;top: 20px;bottom: 20px;position: fixed;font-size:13.5px;background-color: #fff;box-shadow: 0 2px 12px 0 rgba(0, 0, 0, 0.1);border-radius: 3px;color: #666;}                                 .art-sidebar-menu{height: 28px;display: flex;border-bottom: 1px #eee solid;font-weight: 600;padding: 10px 20px 6px;text-align:center;font-size: 14px}.art-sidebar-menu-span{padding: 0 15px 5px;cursor: pointer;}                                .art-sidebar-menu-select{border-bottom: 4px #666 solid;}                                .art-sidebar-main{height: calc(100% - 50px);padding: 3px 0 4px}")},created:function(e,t){return e.get("sidebar")}},R={created:function(e,t){return e.get("toolbar").add({title:"侧边栏",click:function(){return e.get("sidebar").openOrClose()}})}},O=function(e,t,n,r,o,i,s,a){this.anchorInlineOffset=e,this.focusInlineOffset=t,this.anchorAlineOffset=n,this.focusAlineOffset=r,this.anchorOffset=o,this.anchorNode=i,this.focusNode=a,this.focusOffset=s},L=function(){function e(e){this.mountDom=e,this.location=null}return e.prototype.getSelection=function(){var t=e.sel,n=t.anchorNode,r=t.anchorOffset,o=t.focusNode,s=t.focusOffset;if(n&&o){var a=n,l=r;if(a==this.mountDom)return this.location=null,this.location;for(;a.parentNode!=this.mountDom;){for(;a.previousSibling;)a=a.previousSibling,i.b.hasClass(a,"art-shield")||(l+=a.textContent.length);a=a.parentNode}for(var d=o,c=s;d.parentNode!==this.mountDom;){for(;d.previousSibling;)d=d.previousSibling,i.b.hasClass(d,"art-shield")||(c+=d.textContent.length);d=d.parentNode}for(var h=-1,u=0;u<this.mountDom.childNodes.length;u++)if(this.mountDom.childNodes[u]===a){h=u;break}var p=-1;for(u=0;u<this.mountDom.childNodes.length;u++)if(this.mountDom.childNodes[u]===d){p=u;break}var f=n.parentNode.nodeName;0!=r||null!=n.previousSibling||"LI"!=f&&"P"!=f&&"TH"!=f&&"TD"!=f||(n=n.parentNode),this.location=new O(l,c,h,p,r,n,s,o)}else this.location=null;return this.location},e.prototype.searchNode=function(e,t){if(1==e.childNodes.length&&"#text"==e.childNodes[0].nodeName){if(t<=e.childNodes[0].textContent.length)return[e.childNodes[0],t];t-=e.textContent.length}else for(var n=0;n<e.childNodes.length;n++)if(!i.b.hasClass(e.childNodes[n],"art-shield")){if(!(e.childNodes[n].textContent.length<t))return"#text"===e.childNodes[n].nodeName?[e.childNodes[n],t]:this.searchNode(e.childNodes[n],t);t-=e.childNodes[n].textContent.length}return 1==t&&e.nextSibling?[e.nextSibling,0]:null},e.prototype.setTool=function(e){for(var t=this.mountDom.getElementsByClassName("art-tocTool"),n=0;n<t.length;n++)t[n].style.visibility="hidden",t[n].nextSibling.style.borderColor="#9990";if(i.b.hasClass(e,"art-shield"))return!!i.b.hasClass(e,"art-toc")&&(e.previousSibling&&i.b.hasClass(e.previousSibling,"art-tocTool")&&(e.previousSibling.style.visibility="visible",e.style.borderColor="#999"),!0);t=this.mountDom.getElementsByClassName("art-codeTool");for(n=0;n<t.length;n++)t[n].style.visibility="hidden";t=this.mountDom.getElementsByClassName("art-tableTool");for(n=0;n<t.length;n++)t[n].style.visibility="hidden";if(xe.plugins.flowchart){t=this.mountDom.getElementsByClassName("art-flowTool");for(n=0;n<t.length;n++)t[n].style.border="inherit",t[n].previousSibling.style.display="none"}return"PRE"==e.nodeName?(i.b.hasClass(e.previousSibling,"art-codeTool")&&(e.previousSibling.style.visibility="visible"),xe.plugins.flowchart&&i.b.hasClass(e,"art-pre-flow")&&(e.style.display="inherit",e.nextSibling.style.border="1px solid #999"),!0):"TABLE"==e.nodeName&&(i.b.hasClass(e.previousSibling,"art-tableTool")&&(e.previousSibling.style.visibility="visible"),!0)},e.prototype.setSelection=function(t){if(void 0===t&&(t=void 0),null!=typeof t&&t||(t=this.location),!t)return!1;for(var n=this.mountDom.getElementsByClassName("art-show"),r=n.length-1;r>=0;r--){d=(d=n[r].getAttribute("class")).replace("art-show","art-hide"),n[r].setAttribute("class",d)}if(this.location&&this.location.anchorInlineOffset==this.location.focusInlineOffset&&this.location.anchorAlineOffset==this.location.focusAlineOffset){var o=null,s=this.mountDom.childNodes[this.location.focusAlineOffset],a=this.location.anchorInlineOffset;if(this.setTool(s),console.log(this.location),/art-shield/.test(s.className))return null;if(o="HR"==s.nodeName?[s,0]:0!=this.location.anchorOffset||"LI"!==this.location.anchorNode.nodeName&&"TH"!==this.location.anchorNode.nodeName&&"P"!==this.location.anchorNode.nodeName&&"TD"!==this.location.anchorNode.nodeName?0==this.location.anchorOffset&&this.location.anchorNode.parentNode&&("CODE"==this.location.anchorNode.parentNode.nodeName&&"PRE"==this.location.anchorNode.parentNode.parentNode.nodeName||"CODE"==this.location.anchorNode.nodeName&&"PRE"==this.location.anchorNode.parentNode.nodeName)?[this.location.anchorNode,0]:this.searchNode(s,a):[this.location.anchorNode,0],console.log(o),null===o)return null;var l=this.mountDom.getElementsByClassName("art-show-math");for(r=l.length-1;r>=0;r--){d=(d=l[r].getAttribute("class")).replace("art-show-math",""),l[r].setAttribute("class",d)}if("#text"==o[0].nodeName&&i.b.hasClass(o[0].parentNode,"art-math"))(null==(d=o[0].parentNode.previousSibling.childNodes[0].getAttribute("class"))||d.indexOf("art-show-math")<0)&&(d="art-show-math",o[0].parentNode.previousSibling.childNodes[0].setAttribute("class",d));e.setCursor(o[0],o[1]);var d,c=o[0].parentNode;if(c&&i.b.hasClass(c,"art-hide")&&(c.previousSibling&&i.b.hasClass(c.previousSibling,"art-text-double")?c=c.previousSibling:c.nextSibling&&i.b.hasClass(c.nextSibling,"art-text-double")&&(c=c.nextSibling)),c&&i.b.hasClass(c,"art-text-double"))d=(d=c.nextSibling.getAttribute("class")).replace("art-hide","art-show"),c.nextSibling.setAttribute("class",d),d=(d=c.previousSibling.getAttribute("class")).replace("art-hide","art-show"),c.previousSibling.setAttribute("class",d);if("#text"===o[0].nodeName&&i.b.hasClass(o[0].parentNode,"art-hide"))d=(d=o[0].parentNode.getAttribute("class")).replace("art-hide","art-show"),o[0].parentNode.setAttribute("class",d)}},e.setCursor=function(t,n){if(null==t&&!t)return!1;var r=e.sel.getRangeAt(0).cloneRange();r.setStart(t,n),r.collapse(!0),e.sel.removeAllRanges(),e.sel.addRange(r)},e.prototype.moveCursor=function(e){switch(e){case"ArrowRight":this.location.anchorOffset++,this.location.focusOffset++,this.location.anchorInlineOffset++,this.location.focusInlineOffset++;break;default:return!1}return this.setSelection(),!0},e.sel=window.getSelection(),e}(),H=function(){function e(){this.dom=document.createElement("ul"),this.dom.style.display="none",this.dom.setAttribute("class","art-floatTool")}return e.prototype.createDom=function(){this.createLi("使用百度搜索",this.search);var e=document.createElement("li");return e.className="art-divider",this.dom.appendChild(e),this.createLi("剪切",this.cut),this.createLi("复制",this.copy),this.createLi("粘贴",this.paste),this.dom},e.prototype.open=function(e,t){this.dom.style.display="inherit",this.dom.style.top=e.toString()+"px",this.dom.style.left=t.toString()+"px"},e.prototype.close=function(){this.dom.style.display="none"},e.prototype.createLi=function(e,t){var n=document.createElement("li");n.setAttribute("class","art-floatTool-li"),n.innerText=e;var r=this;return n.onmousedown=function(){t(r)},this.dom.appendChild(n),n},e.prototype.search=function(e){var t=window.getSelection().toString();e.dom.style.display="none",window.open("https://www.baidu.com/s?ie=UTF-8&wd="+t)},e.prototype.copy=function(e){return e.dom.style.display="none",document.execCommand("Copy"),!0},e.prototype.cut=function(e){e.dom.style.display="none",document.execCommand("Cut")},e.prototype.paste=function(e){e.dom.style.display="none",document.execCommand("Paste")},e}();function $(e,t){return null}var z,j=function(e){this.nodeName=e},B=(z=function(e,t){return(z=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}z(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),I=function(e){function t(t){var n=e.call(this,"#text")||this;return n.text=t,n.parentNode=null,n.dom=null,n}return B(t,e),t.prototype.newDom=function(){return this.dom=document.createTextNode(this.text),this.dom},t.prototype.getMd=function(){return this.text},t.prototype.getText=function(){return this.text},t}(j);function F(e){console.log(e)}function P(e,t){void 0===t&&(t=""),e.innerHTML="",e.setAttribute("style","visibility:hidden;");var n=document.createElement("span");n.style.letterSpacing="4px",n.style.color="#aaa",n.style.position="relative",n.style.top="3px",n.innerHTML="```";var r=document.createElement("input");r.setAttribute("style","font-size:14px;letter-spacing:1px;font-weight: 600;padding: 1px 2px;border: none;outline: none;color: #1abc9c;display: flex;flex-direction: column;flex: 1 1 0%;"),r.title="设置代码语言",r.value=t,r.onchange=V,e.appendChild(n),e.appendChild(r)}function V(){this.parentNode.nextSibling.childNodes[0].className="lang-"+this.value}function q(e){e.innerHTML="",e.style.visibility="hidden";var t=document.createElement("span");t.style.fontWeight="600",t.innerHTML="目录";var n=document.createElement("button");n.setAttribute("class","art-buttonTool-hover"),n.innerHTML='<svg class="icon" style="width: 18px; height: 18px;color: red;vertical-align: middle;fill: currentColor;overflow: hidden;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="689"><path d="M800.162002 316.659033c1.850138-17.575284 17.596773-30.322609 35.172058-28.473495 17.575284 1.850138 30.322609 17.596773 28.473494 35.172058l-57.966202 550.673811c-5.143137 48.856731-46.341445 85.946464-95.467306 85.946464H313.625954c-49.126884 0-90.325192-37.089733-95.468329-85.946464L160.192446 323.358619c-1.850138-17.575284 10.898211-33.32192 28.472471-35.172057 17.575284-1.850138 33.32192 10.898211 35.172058 28.473494l57.965179 550.672788c1.714038 16.285918 15.446807 28.64848 31.822776 28.648481h396.74707c16.375969 0 30.108738-12.363585 31.822776-28.648481l57.967226-550.673811z m-192.176904 99.345636c17.672498 0 31.998785 14.326287 31.998785 31.998785v223.989447c0 17.672498-14.326287 31.998785-31.998785 31.998785s-31.998785-14.326287-31.998785-31.998785V448.00243c0-17.671475 14.326287-31.997762 31.998785-31.997761z m-191.990662 0c17.672498 0 31.998785 14.326287 31.998785 31.998785v223.989447c0 17.672498-14.326287 31.998785-31.998785 31.998785s-31.998785-14.326287-31.998785-31.998785V448.00243c0-17.671475 14.326287-31.997762 31.998785-31.997761z m-31.998785-223.989447h255.987209v-47.998178c0-8.836249-7.163143-15.999392-15.999393-15.999392H399.995043c-8.836249 0-15.999392 7.163143-15.999392 15.999392v47.998178z m-63.996546 0V128.018675c0-35.344996 28.652574-63.996546 63.997569-63.996546h255.987209c35.343973 0 63.996546 28.652574 63.996546 63.996546v63.996547h223.99968c17.672498 0 31.998785 14.326287 31.998785 31.998785s-14.326287 31.998785-31.998785 31.998784H96.019891c-17.672498 0-31.998785-14.326287-31.998785-31.998784s14.326287-31.998785 31.998785-31.998785h223.979214z" p-id="690"></path></svg>',n.title="删除目录",n.style.position="absolute",n.style.right="0",n.style.top="-2px",n.onclick=K,e.appendChild(t),e.appendChild(n)}function K(e){var t=e.target.parentNode.parentNode;t.nextSibling&&i.b.hasClass(t.nextSibling,"art-toc")&&(t.parentNode.removeChild(t.nextSibling),t.parentNode.removeChild(t))}function U(e){return new J(e)}var J=function(){function e(e){this.rootDom=e,e.innerHTML="",e.setAttribute("style","width:100%;visibility:hidden;font-size:14px;position:relative;margin-bottom: 2px;"),e.appendChild(this.createAdjustSpan()),e.appendChild(this.createAlignSpan()),e.appendChild(this.createDelButton()),e.appendChild(this.createMoreButton())}return e.prototype.createAlignSpan=function(){var e=document.createElement("button");e.setAttribute("class","art-buttonTool-hover"),e.onclick=this.align("left"),e.innerHTML="左";var t=document.createElement("button");t.setAttribute("class","art-buttonTool-hover"),t.onclick=this.align("center"),t.innerHTML="中";var n=document.createElement("button");n.setAttribute("class","art-buttonTool-hover"),n.onclick=this.align("right"),n.innerHTML="右";var r=document.createElement("span");return r.appendChild(e),r.appendChild(t),r.appendChild(n),r},e.prototype.createAdjustSpan=function(){var e=document.createElement("input");e.setAttribute("style","width:35px;margin:0 7px;;font-size:14px;font-weight: 600;color: #1abc9c;border: none;outline: none;"),e.title="调整行";var t=document.createElement("input");t.setAttribute("style","width:35px;font-size:14px;font-weight: 600;color: #1abc9c;border: none;outline: none;"),t.title="调整列";var n=document.createElement("span");n.style.display="none",n.appendChild(e),n.appendChild(t);var r=document.createElement("button");return r.style.marginLeft="0",r.setAttribute("class","art-buttonTool-hover"),r.innerHTML='<svg class="icon" style="width: 18px; height: 18px;vertical-align: middle;fill: currentColor;overflow: hidden;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1283"><path d="M64.021106 512c0-17.672498 14.07353-31.998785 31.887244-31.998785h832.182277c17.6111 0 31.887244 14.202467 31.887244 31.998785 0 17.672498-14.07353 31.998785-31.887244 31.998785H95.909373c-17.6111 0-31.888268-14.20349-31.888267-31.998785zM959.977871 352.007099c0 17.672498-14.326287 31.998785-31.998785 31.998785s-31.998785-14.326287-31.998785-31.998785V160.016437c0-17.672498-14.326287-31.998785-31.998784-31.998785H160.016437c-17.672498 0-31.998785 14.326287-31.998785 31.998785v191.990662c0 17.672498-14.326287 31.998785-31.998785 31.998785s-31.998785-14.326287-31.998785-31.998785V160.016437c0-53.016471 42.97886-95.995331 95.995332-95.995331H863.981517c53.016471 0 95.995331 42.97886 95.995331 95.995331v191.990662z m0 319.984779v191.990662c0 53.016471-42.97886 95.995331-95.995331 95.995331H160.016437c-53.016471 0-95.995331-42.97886-95.995331-95.995331V671.991878c0-17.672498 14.326287-31.998785 31.998785-31.998785s31.998785 14.326287 31.998784 31.998785v191.990662c0 17.672498 14.326287 31.998785 31.998785 31.998785h703.966103c17.672498 0 31.998785-14.326287 31.998785-31.998785V671.991878c0-17.672498 14.326287-31.998785 31.998785-31.998785s31.996738 14.32731 31.996738 31.998785z" p-id="1284"></path></svg>',r.title="调整大小",r.onclick=this.sizeBoxAdjust,r.appendChild(n),r},e.prototype.createMoreButton=function(){var e=document.createElement("button");return e.setAttribute("style","float: right;"),e.setAttribute("class","art-buttonTool-hover"),e.innerHTML='<svg class="icon" style="width: 18px;height: 18px;vertical-align: middle;fill: currentColor;overflow: hidden;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1135"><path d="M417.696 224c0-52.928 43.072-96 96-96s96 43.072 96 96-43.072 96-96 96S417.696 276.928 417.696 224zM417.696 512c0-52.928 43.072-96 96-96s96 43.072 96 96-43.072 96-96 96S417.696 564.928 417.696 512zM417.696 800c0-52.928 43.072-96 96-96s96 43.072 96 96-43.072 96-96 96S417.696 852.928 417.696 800z" p-id="1136"></path></svg>',e.title="更多",e.onclick=this.openMore,e},e.prototype.createDelButton=function(){var e=document.createElement("button");return e.setAttribute("style","float: right;"),e.setAttribute("class","art-buttonTool-hover"),e.innerHTML='<svg class="icon" style="width: 18px; height: 18px;color: red;vertical-align: middle;fill: currentColor;overflow: hidden;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="689"><path d="M800.162002 316.659033c1.850138-17.575284 17.596773-30.322609 35.172058-28.473495 17.575284 1.850138 30.322609 17.596773 28.473494 35.172058l-57.966202 550.673811c-5.143137 48.856731-46.341445 85.946464-95.467306 85.946464H313.625954c-49.126884 0-90.325192-37.089733-95.468329-85.946464L160.192446 323.358619c-1.850138-17.575284 10.898211-33.32192 28.472471-35.172057 17.575284-1.850138 33.32192 10.898211 35.172058 28.473494l57.965179 550.672788c1.714038 16.285918 15.446807 28.64848 31.822776 28.648481h396.74707c16.375969 0 30.108738-12.363585 31.822776-28.648481l57.967226-550.673811z m-192.176904 99.345636c17.672498 0 31.998785 14.326287 31.998785 31.998785v223.989447c0 17.672498-14.326287 31.998785-31.998785 31.998785s-31.998785-14.326287-31.998785-31.998785V448.00243c0-17.671475 14.326287-31.997762 31.998785-31.997761z m-191.990662 0c17.672498 0 31.998785 14.326287 31.998785 31.998785v223.989447c0 17.672498-14.326287 31.998785-31.998785 31.998785s-31.998785-14.326287-31.998785-31.998785V448.00243c0-17.671475 14.326287-31.997762 31.998785-31.997761z m-31.998785-223.989447h255.987209v-47.998178c0-8.836249-7.163143-15.999392-15.999393-15.999392H399.995043c-8.836249 0-15.999392 7.163143-15.999392 15.999392v47.998178z m-63.996546 0V128.018675c0-35.344996 28.652574-63.996546 63.997569-63.996546h255.987209c35.343973 0 63.996546 28.652574 63.996546 63.996546v63.996547h223.99968c17.672498 0 31.998785 14.326287 31.998785 31.998785s-14.326287 31.998785-31.998785 31.998784H96.019891c-17.672498 0-31.998785-14.326287-31.998785-31.998784s14.326287-31.998785 31.998785-31.998785h223.979214z" p-id="690"></path></svg>',e.title="删除表格",e.onclick=this.delTable,e},e.prototype.openMore=function(e){e.stopPropagation();var t=e.clientY-40-e.offsetY,n=e.clientX+90-e.offsetX,r=e.target.parentNode.parentNode.nextSibling,o=new CustomEvent("art-event",{detail:{type:"MoreTableTool.open",xy:[n,t],table:r},bubbles:!0,cancelable:!1});return e.target.dispatchEvent(o),!1},e.prototype.align=function(e){return function(){var t=L.sel,n=t.anchorNode,r=t.focusNode;if(n&&r){for(var o=n;"TR"!=o.parentNode.nodeName&&o.parentNode!=document.body;)o=o.parentNode;if("TR"==o.parentNode.nodeName){var i=-1;for(i=o.parentNode.childNodes.length-1;i>=0&&o.parentNode.childNodes[i]!=o;i--);if(-1!=i)for(var s=o.parentNode.parentNode.parentNode,a=0;a<s.rows.length;a++)s.rows[a].cells[i].style.textAlign=e}}}},e.getTableSize=function(e){return e?[e.rows.length,e.rows.item(0).cells.length]:[0,0]},e.setTableSize=function(t,n){if(-1==n[0]||-1==n[1])return null;var r=e.getTableSize(t);if(n[0]!=r[0])if(n[0]<r[0])for(var o=r[0]-1;o>n[0]-1;o--)t.rows[o].parentNode.removeChild(t.rows[o]);else for(o=n[0]-r[0];o>0;o--){for(var i=document.createElement("tr"),s=0;s<r[1];s++){var a=document.createElement("td");i.appendChild(a)}t.childNodes[1].appendChild(i)}if(n[1]!=r[1])if(n[1]<r[1])for(o=r[1]-1;o>n[1]-1;o--)for(s=0;s<t.rows.length;s++)t.rows[s].cells[o].parentNode.removeChild(t.rows[s].cells[o]);else for(o=n[1]-r[1];o>0;o--)for(s=0;s<t.rows.length;s++)0==s?t.rows[s].appendChild(document.createElement("th")):t.rows[s].appendChild(document.createElement("td"))},e.prototype.sizeBoxAdjust=function(t){var n=t.target.parentNode.parentNode;if(n.nextSibling&&"TABLE"==n.nextSibling.nodeName){var r=t.target.nextSibling;if("none"==r.style.display){r.style.display="";var o=e.getTableSize(n.nextSibling);r.childNodes[0].value=o[0].toString(),r.childNodes[1].value=o[1].toString()}else e.setTableSize(n.nextSibling,[parseInt(r.childNodes[0].value),parseInt(r.childNodes[1].value)]),r.style.display="none"}},e.prototype.delTable=function(e){var t=e.target.parentNode.parentNode;t.nextSibling&&"TABLE"==t.nextSibling.nodeName&&(t.parentNode.removeChild(t.nextSibling),t.parentNode.removeChild(t))},e}(),Z=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),X=function(e){function t(t,n,r){void 0===n&&(n={}),void 0===r&&(r=null);var o=e.call(this,t)||this;o.parentNode=null,o.attr=n,o.childNodes=r instanceof Array?r:null==r?[]:[r];for(var i=0,s=o.childNodes;i<s.length;i++){s[i].parentNode=o}return o}return Z(t,e),t.prototype.newDom=function(){var e,t=this;for(var n in this.dom=document.createElement(this.nodeName),this.attr)"__dom__"===n?"tableTool"===this.attr[n]?U(this.dom):"imgTool"===this.attr[n]?this.dom.appendChild((e=void 0,(e=document.createElement("span")).style.fontSize="14px",e.setAttribute("contenteditable","false"),e.innerHTML='<svg class="icon" style="width: 19px; height: 19px;vertical-align: middle;fill: currentColor;overflow: hidden;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1140"><path d="M288.010553 448.00243c-35.344996 0-63.996546-28.652574-63.996546-63.996546s28.652574-63.996546 63.996546-63.996546c35.344996 0 63.996546 28.652574 63.996546 63.996546s-28.65155 63.996546-63.996546 63.996546z m639.969556 302.169018l-258.988565-258.077823L372.528482 759.740384c-12.629645 11.402701-31.975249 10.92584-44.027749-1.084705L220.383316 650.927119l-124.363425 100.357686v80.699973c0 17.672498 14.326287 31.998785 31.998784 31.998785h767.96265c17.672498 0 31.998785-14.326287 31.998784-31.998785v-81.81333z m0-90.346681V192.015222c0-17.672498-14.326287-31.998785-31.998784-31.998785H128.018675c-17.672498 0-31.998785 14.326287-31.998784 31.998785v477.033627l84.173074-67.926042c25.424042-20.516266 62.219063-18.58938 85.361133 4.469801l86.61673 86.306668 273.934976-247.308549c25.261337-22.805402 63.951521-21.851681 88.058569 2.170433l213.815736 213.063607zM32.023344 736.273926a45.762253 45.762253 0 0 1 0-0.530072V192.015222c0-53.016471 42.97886-95.995331 95.995331-95.995331h767.96265c53.016471 0 95.995331 42.97886 95.995331 95.995331v639.969556c0 53.016471-42.97886 95.995331-95.995331 95.995331H128.018675c-53.016471 0-95.995331-42.97886-95.995331-95.995331v-95.710852z" p-id="1141"></path></svg>',e.style.cursor="pointer",e.onclick=F,e)):"codeTool"===this.attr[n]?P(this.dom,this.attr.__dict__.codeLang):"tocTool"==this.attr[n]&&q(this.dom):"art-math"==n?xe.plugins.katex?(this.dom.innerHTML=xe.plugins.katex.renderToString(this.attr["art-math"],{throwOnError:!1}),this.dom.setAttribute(n,this.attr[n])):this.dom.setAttribute(n,"\n@math:katex未加载出@\n"):/^__[a-zA-Z\d]+__$/.test(n)||this.dom.setAttribute(n,this.attr[n]);return this.childNodes.forEach((function(e){t.dom.appendChild(e.newDom())})),this.dom},t.prototype.appendChild=function(e){return this.childNodes.push(e),e.parentNode=this,!0},t.prototype.replaceChild=function(e,t){var n=this.childNodes.indexOf(t);return-1!=n&&(e.parentNode=this,this.childNodes[n]=e,!0)},t.prototype.replaceAllChild=function(e){if(e){this.childNodes=[];for(var t=0,n=e;t<n.length;t++){var r=n[t];this.appendChild(r)}return!0}return!1},t.prototype.insertBefore=function(e,t){var n=this.childNodes.indexOf(t);return-1!=n&&(e.parentNode=this,this.childNodes.splice(n,0,e),!0)},t.prototype.insertAfter=function(e,t){var n=this.childNodes.indexOf(t);return-1!=n&&(e.parentNode=this,this.childNodes.splice(n+1,0,e),!0)},t.prototype.removeChild=function(e){var t=this.childNodes.indexOf(e);return-1!=t&&(this.childNodes.splice(t,1),!0)},t.prototype.hasClass=function(e){return!!this.attr.class&&(" "+this.attr.class+" ").indexOf(" "+e+" ")>-1},t.prototype.getMd=function(e){void 0===e&&(e="editor");var t="";if(/art-toc(\s|$)/.test(this.attr.class))return"[TOC]\n";if("a"==this.nodeName&&this.childNodes.length>0)t+=this.childNodes[0].text;else{if(this.attr.class&&/art-shield/.test(this.attr.class))return"";if("read"==e)if("hr"==this.nodeName)t+="***\n";else if("input"==this.nodeName&&"checkbox"==this.attr.type)"checked"==this.attr.checked?t+="[x] ":t+="[ ] ";else if("blockquote"==this.nodeName)for(var n=0;n<this.childNodes.length;n++)for(var r=0,o=a=this.childNodes[n].getMd(e).replace(/\s$/,"").split("\n");r<o.length;r++){t+="> "+o[r]+"\n"}else if("ul"==this.nodeName)for(n=0;n<this.childNodes.length;n++)for(var i=0,s=a=this.childNodes[n].getMd(e).replace(/\s$/,"").split("\n");i<s.length;i++){t+="* "+s[i]+"\n"}else if("ol"==this.nodeName)for(n=0;n<this.childNodes.length;n++)for(var a,l=0,d=(a=this.childNodes[n].getMd(e).replace(/\s$/,"").split("\n")).length;l<d;l++)t+=0==l?(n+1).toString()+". "+a[l]+"\n":"   "+a[l]+"\n";else if("li"==this.nodeName)for(n=0;n<this.childNodes.length;n++)t+=this.childNodes[n].getMd(e);else if("h1 h2 h3 h4 h5 h6".indexOf(this.nodeName)>=0||"p"==this.nodeName){for(n=0;n<this.childNodes.length;n++)t+=this.childNodes[n].getMd(e);t+="\n"}else if("table"==this.nodeName)for(var c=0;c<this.childNodes.length;c++)for(n=0;n<this.childNodes[c].childNodes.length;n++){var h=this.childNodes[c].childNodes[n];t+="|";for(l=0;l<h.childNodes.length;l++)t+=h.childNodes[l].getMd(e)+"|";if(t+="\n",0==c){t+="|";for(l=0;l<h.childNodes.length;l++){var u=h.childNodes[l],p=void 0;if(u.attr.style&&(p=u.attr.style.match(/text-align:\s*?(left|center|right)/)))switch(p[1]){case"center":t+=":---:|";break;case"left":t+=":---|";break;case"right":t+="---:|";break;default:t+=":---:"}else t+="---|"}t+="\n"}}else if("pre"==this.nodeName){t+="```";var f=this.childNodes[0].attr.class;if(f){var m=f.match(/lang-(.*?)(\s|$)/);m&&(t+=m[1])}t+="\n";for(n=0;n<this.childNodes.length;n++)t+=this.childNodes[n].getMd(e);t+="```\n"}else for(n=0;n<this.childNodes.length;n++)t+=this.childNodes[n].getMd(e);else for(n=0;n<this.childNodes.length;n++)t+=this.childNodes[n].getMd(e)}return t},t.prototype.getText=function(){for(var e="",t=0,n=this.childNodes;t<n.length;t++){var r=n[t];"#text"==r.nodeName?e+=r.getText():null==r.attr.class||/(art\-shield)|(art\-hide)|(art\-show)/.test(r.attr.class)||(e+=r.getText())}return e},t}(j);function G(e){if(""===e)return[new X("br")];for(var t,n,r=[];e;){n=null;for(var o=0;o<Q.length;o++)if(t=e.match(Q[o].re)){if(0==t.index){n=[t,Q[o]];break}n?n[0].index>t.index&&(n=[t,Q[o]]):n=[t,Q[o]]}if(!n){r.push(new I(e));break}0!=n[0].index&&r.push(new I(e.substring(0,n[0].index))),n[1].fun(n[0][0]).forEach((function(e){r.push(e)})),e=e.substring(n[0].index+n[0][0].length)}return r}var Q=[{tag:"escape",left:"\\",right:"null",re:/\\(\S{1})/,fun:function(e){return[new X("span",{class:"art-hide"},new I("\\")),new I(e.substring(1))]}},{tag:"bi",left:"***",right:"***",re:/(\*{3})([^\*].*?)(\*{3})/,fun:function(e){var t=new X("span",{class:"art-hide"},new I("***")),n=new X("span",{class:"art-text-double"},new I(e.substring(3,e.length-3))),r=new X("span",{class:"art-hide"},new I("***"));return[new X("i",{},new X("b",{},[t,n,r]))]}},{tag:"b",left:"**",right:"**",re:/(\*{2})([^\*].*?)(\*{2})/,fun:function(e){return W(["**",2,e,"**","b"])}},{tag:"mark",left:"==",right:"==",re:/\={2}[^\=].*?\={2}/,fun:function(e){return W(["==",2,e,"==","mark"])}},{tag:"code",left:"`",right:"`",re:/`[^`]+`/,fun:function(e){return W(["`",1,e,"`","code"])}},{tag:"i",left:"*",right:"*",re:/(\*)([^\*].*?)(\*)/,fun:function(e){return W(["*",1,e,"*","i"])}},{tag:"img",left:"![",centre:"](",right:")",re:/!\[.*?\]\(.*?\)/,fun:function(e){var t=e.match(/\(.*\)/)[0],n=e.match(/\[.*\]/)[0],r=new X("span",{class:"art-hide"},[new X("span",{class:"art-shield",__dom__:"imgTool"},[]),new I(e)]),o=new X("img",{src:t.substring(1,t.length-1),alt:n.substring(1,n.length-1),contenteditable:"false",style:"margin: 0 auto;display: block;"},null);return[r,o]}},{tag:"a",left:"[",centre:"](",right:")",re:/\[.*?\]\(.*?\)/,fun:function(e){var t=e.match(/\(.*\)/)[0],n=e.match(/\[.*\]/)[0],r=new X("span",{class:"art-hide"},new I("[")),o=new X("a",{href:t.substring(1,t.length-1),class:"art-text-double",title:"alt+点击",style:"cursor: pointer;"},new I(n.substring(1,n.length-1))),i=new X("span",{class:"art-hide"},new I("]"+t));return[r,o,i]}},{tag:"math",left:"$",right:"$",re:/\$.*?\$/,fun:function(e){if(xe.plugins.katex){var t=new X("span",{class:"art-hide art-math"},new I(e));return[new X("span",{class:"art-shield",style:"position: relative;",contenteditable:"false",__dom__:"math"},new X("span",{style:"top: 35px;display: inline-table;","art-math":e.substring(1,e.length-1)},null)),t]}return[new X("span",{style:"color: #777"},new I(e))]}},{tag:"del",left:"~~",right:"~~",re:/~{2}.*?~{2}/,fun:function(e){return W(["~~",2,e,"~~","del"])}},{tag:"ins",left:"__",right:"__",re:/_{2}.*?_{2}/,fun:function(e){return W(["__",2,e,"__","ins"])}},{tag:"sup",left:"^",right:"^",re:/\^[^\^]+\^/,fun:function(e){return Y(["^",1,e,"^","sup"])}},{tag:"sub",left:"~",right:"~",re:/~[^~\s]+~/,fun:function(e){return Y(["~",1,e,"~","sub"])}},{tag:"html_tag",left:"null",right:"null",re:/(<!--[\s\S]*?-->|(<([a-zA-Z]{1}[a-zA-Z\d-]*) *[^\n<>]* *(?:\/)?>)(?:([\s\S]*?)(<\/\3 *>))?)/,fun:function(e){var t=/\s([a-z]+)="(.*?)"/,n=e.match(/^<([a-zA-Z]+)( .*?)?>([\s\S]*?)<\/\1+>/);if(null==n)return[new I(e)];var r={class:"art-text-double"};if(n[2])for(var o=n[2].match(/\s([a-z]+)="(.*?)"/g),i=0;i<o.length;i++){var s=o[i].match(t);r[s[1]]=s[2]}"art-text-double"!=r.class&&(r.class+=" art-text-double");null==n[2]&&(n[2]="");var a=new X("span",{class:"art-hide"},new I("<"+n[1]+n[2]+">")),l=new X(n[1],r,G(n[3])),d=new X("span",{class:"art-hide"},new I("</"+n[1]+">"));return[a,l,d]}}];function W(e){return[new X("span",{class:"art-hide"},new I(e[0])),new X(e[4],{class:"art-text-double"},G(e[2].substring(e[1],e[2].length-e[1]))),new X("span",{class:"art-hide"},new I(e[3]))]}function Y(e){var t=new X("span",{class:"art-hide"},new I(e[0])),n=new X("span",{class:"art-text-double"},G(e[2].substring(e[1],e[2].length-e[1]))),r=new X("span",{class:"art-hide"},new I(e[3]));return[new X(e[4],{},[t,n,r])]}var ee=G,te=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],s=0,a=i.length;s<a;s++,o++)r[o]=i[s];return r};function ne(e){if(""===e)return[new X("p",{},new X("br"))];for(var t=0;t<re.length;t++)if(e.match(re[t].re))return re[t].fun(e);return null}var re=[{first:"#",last:"",re:/^#\s/,fun:function(e){var t=te([new X("span",{class:"art-hide"},new I("# "))],ee(e.substring(2))),n=new X("h1",{},t),r=n.getMd();return r=r.replace(/\s/g,"-").replace(/\\|\/|#|\:/g,""),n.childNodes.unshift(new X("a",{class:"art-shield",name:r},null)),[n]}},{first:"##",last:"",re:/^##\s/,fun:function(e){var t=te([new X("span",{class:"art-hide"},new I("## "))],ee(e.substring(3))),n=new X("h2",{},t),r=n.getMd();return r=r.replace(/\s/g,"-").replace(/\\|\/|#|\:/g,""),n.childNodes.unshift(new X("a",{class:"art-shield",name:r},null)),[n]}},{first:"###",last:"",re:/^###\s/,fun:function(e){var t=te([new X("span",{class:"art-hide"},new I("### "))],ee(e.substring(4))),n=new X("h3",{},t),r=n.getMd();return r=r.replace(/\s/g,"-").replace(/\\|\/|#|\:/g,""),n.childNodes.unshift(new X("a",{class:"art-shield",name:r},null)),[n]}},{first:"####",last:"",re:/^####\s/,fun:function(e){var t=te([new X("span",{class:"art-hide"},new I("#### "))],ee(e.substring(5))),n=new X("h4",{},t),r=n.getMd();return r=r.replace(/\s/g,"-").replace(/\\|\/|#|\:/g,""),n.childNodes.unshift(new X("a",{class:"art-shield",name:r},null)),[n]}},{first:"#####",last:"",re:/^#####\s/,fun:function(e){var t=te([new X("span",{class:"art-hide"},new I("##### "))],ee(e.substring(6))),n=new X("h5",{},t),r=n.getMd();return r=r.replace(/\s/g,"-").replace(/\\|\/|#|\:/g,""),n.childNodes.unshift(new X("a",{class:"art-shield",name:r},null)),[n]}},{first:"######",last:"",re:/^######\s/,fun:function(e){var t=te([new X("span",{class:"art-hide"},new I("###### "))],ee(e.substring(7))),n=new X("h6",{},t),r=n.getMd();return r=r.replace(/\s/g,"-").replace(/\\|\/|#|\:/g,""),n.childNodes.unshift(new X("a",{class:"art-shield",name:r},null)),[n]}}];var oe=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],s=0,a=i.length;s<a;s++,o++)r[o]=i[s];return r};function ie(e,t,n){return""==e?new X("li",{__match__:n},new X("p",{},new X("br"))):"ul"==t&&/^\[x|X\]\s/.test(e)?new X("li",{__match__:n,style:"list-style:none"},new X("p",{},oe([new X("input",{type:"checkbox",checked:"checked"})],ee(e.substring(4))))):"ul"==t&&/^\[\s\]\s/.test(e)?new X("li",{__match__:n,style:"list-style:none"},new X("p",{},oe([new X("input",{type:"checkbox"})],ee(e.substring(4))))):/^\*\s/.test(e)?new X("li",{__match__:n},new X("ul",{},ie(e.substring(2),"ul","*"))):/^\s{2}\*\s/.test(e)?new X("li",{__match__:n},new X("ul",{},ie(e.substring(2),"ul"," "))):/^\d\.\s/.test(e)?new X("li",{__match__:n},new X("ol",{},ie(e.substring(3),"ol","d."))):/^>\s/.test(e)?new X("li",{__match__:n},new X("blockquote",{},se(e.substring(2)))):new X("li",{__match__:n},new X("p",{},ee(e)))}function se(e){return""==e?new X("p",{},new X("br")):/^>\s/.test(e)?new X("blockquote",{},se(e.substring(2))):/^\*\s/.test(e)?new X("ul",{},ie(e.substring(2),"ul","*")):/^\d\.\s/.test(e)?new X("ol",{},ie(e.substring(3),"ol","d.")):new X("p",{},ee(e))}function ae(e){var t=e.childNodes,n=[];n.push(t[0]);for(var r=1;r<t.length;r++)if(t[r]instanceof I)n.push(t[r]);else{var o=t[r].childNodes[0],i=n[n.length-1].childNodes[0];" "!=t[r].attr.__match__||"ul"!=o.nodeName||"p"!=i.nodeName&&"ul"!=i.nodeName?"ul"==t[r].nodeName&&"ul"==n[n.length-1].nodeName?n[n.length-1].appendChild(o):" "!=t[r].attr.__match__||"ol"!=o.nodeName||"p"!=i.nodeName&&"ol"!=i.nodeName?"ol"==t[r].nodeName&&"ol"==n[n.length-1].nodeName||"blockquote"==t[r].nodeName&&"blockquote"==n[n.length-1].nodeName?n[n.length-1].appendChild(o):n.push(t[r]):n[n.length-1].appendChild(o):n[n.length-1].appendChild(o),n[n.length-1].childNodes.length>1&&(n[n.length-1]=ae(n[n.length-1]))}return e.replaceAllChild(n),e}function le(e,t,n){for(var r=0;r<de.length;r++)if(e[t].match(de[r].re))return de[r].fun(e,t,n);return null}var de=[{re:/^>\s/,fun:function(e,t,n){var r=[];for(;t<n&&/^>\s/.test(e[t]);)r.push(se(e[t].substring(2))),t++;t<n&&/^\s*$/.test(e[t+1])||t--;return[[ae(new X("blockquote",{},r))],t]}},{re:/^\*\s/,fun:function(e,t,n){var r=[];for(;t<n;)if(/^\*\s/.test(e[t]))r.push(ie(e[t].substring(2),"ul","*")),t++;else{if(!/^\s{2,}\*\s/.test(e[t]))break;r.push(ie(e[t].substring(2),"ul"," ")),t++}t<n&&/^\s*$/.test(e[t+1])||t--;return[[ae(new X("ul",{},r))],t]}},{re:/^\d\.\s/,fun:function(e,t,n){var r=[];for(;t<n;)if(/^\d\.\s/.test(e[t]))r.push(ie(e[t].substring(3),"ol","d.")),t++;else{if(!/^\s{3,}\d\.\s/.test(e[t])&&!/^\s{3,}\*\s/.test(e[t]))break;r.push(ie(e[t].substring(3),"ol"," ")),t++}t<n&&/^\s*$/.test(e[t+1])||t--;return[[ae(new X("ol",{},r))],t]}},{re:/^```/,fun:function(e,t,n){var r,o=[],i=e[t].match(/^```\s*([^\s]*?)\s*$/)[1],s=!1,a="";for(r=t+1;r<n;r++){if(/^```$/.test(e[r])){s=!0;break}a+=e[r]+"\n"}if(s){t=r;var l=void 0;null!=i&&null!=i||(i=""),o.push(new X("div",{class:"art-shield art-codeTool",contenteditable:"false",__dom__:"codeTool",__dict__:{codeLang:i}})),""!=i?(l=new X("code",{class:"lang-"+i},new I(a)),o.push(new X("pre",{class:"art-pre-"+i},l)),"flow"==i&&o.push(new X("div",{class:"art-shield art-flowTool",contenteditable:"false"},[]))):(l=new X("code",{},new I(a)),o.push(new X("pre",{},l))),t+1<n&&/^\s*$/.test(e[t+1])&&t++}else o.push(new X("p",{},new I(e[t]))),t+1<n&&""==e[t+1]&&t++;return[o,t]}},{re:/^\|.*\|/,fun:function(e,t,n){var r=[],o=[];if(t+1<n&&/^\|(\s*:?-{3,}:?\s*\|)+/.test(e[t+1])){var i=void 0,s=void 0,a=void 0,l=void 0,d=void 0,c=void 0,h=void 0;for(i=e[t+1].split("|"),c=[],s=1,a=i.length-1;s<a;s++){var u=i[s].replace(/(^\s*)|(\s*$)/g,"");":"==u[0]&&":"==u[u.length-1]?c.push("center"):":"==u[0]?c.push("left"):":"==u[u.length-1]?c.push("right"):c.push("")}for(r=[],i=e[t].split("|"),l=[],s=1,a=i.length-1;s<a;s++)h={},c[s-1]&&(h.style="text-align:"+c[s-1]),l.push(new X("th",h,ee(i[s])));for(r.push(new X("thead",{},new X("tr",{},l))),t+=2,d=[];t<n&&/^\|.*\|/.test(e[t]);){for(i=e[t].split("|"),l=[],s=1,a=i.length-1;s<a;s++)h={},c[s-1]&&(h.style="text-align:"+c[s-1]),l.push(new X("td",h,ee(i[s])));d.push(new X("tr",{},l)),t++}t<n&&/^\s*$/.test(e[t+1])||t--,o.push(new X("div",{class:"art-shield art-tableTool",contenteditable:"false",__dom__:"tableTool"})),r.push(new X("tbody",{},d)),o.push(new X("table",{style:"width:100%;"},r))}else o.push(new X("p",{},ee(e[t]))),t+1<n&&/^\s*$/.test(e[t+1])&&t++;return[o,t]}},{re:/^(\*{3,}$|^\-{3,}$|^\_{3,}$)/,fun:function(e,t,n){var r=[];r.push(new X("hr")),t+1<n&&/^\s*$/.test(e[t+1])&&t++;return[r,t]}},{re:/^\[(TOC)|(toc)\]$/,fun:function(e,t,n){var r=[];r.push(new X("div",{class:"art-shield art-tocTool",contenteditable:"false",__dom__:"tocTool"})),r.push(new X("div",{class:"art-shield art-toc",contenteditable:"false",__dom__:"toc"})),t+1<n&&/^\s*$/.test(e[t+1])&&t++;return[r,t]}}];function ce(e){if("#text"==e.nodeName)return new I(e.nodeValue);for(var t=new X(e.nodeName.toLowerCase(),{},[]),n=0;n<e.attributes.length;n++){var r=e.attributes[n];t.attr[r.localName]=r.value}"INPUT"==e.nodeName&&(e.checked?t.attr.checked="checked":t.attr.checked&&delete t.attr.checked);for(n=0;n<e.childNodes.length;n++)t.appendChild(ce(e.childNodes[n]));return t}var he=function(){function e(e){this.isComposition=!1,this.DOMEvents=[],this.customizeEvents=[],this.artRender=e}return e.prototype.attachAllEvent=function(){this.artRender.dom.setAttribute("contenteditable","true");var e=this;this.addCustomizeEvent("MoreTableTool.open",(function(t){return e.artRender.tableMoreTool.open(t.xy,t.table),!1})),this.addCustomizeEvent("DOM.click",(function(){e.artRender.floatAuxiliaryTool.close(),e.artRender.tableMoreTool.close()})),this.addCustomizeEvent("DOM.mousewheel",(function(){e.artRender.floatAuxiliaryTool.close(),e.artRender.tableMoreTool.close()})),this.addDOMEvent("keydown",this.keydown),this.addDOMEvent("keyup",this.keyup),this.addDOMEvent("compositionstart",(function(e,t){return t.isComposition=!0})),this.addDOMEvent("compositionend",(function(e,t){return t.isComposition=!1})),this.addDOMEvent("click",this.click),this.addDOMEvent("contextmenu",this.contextmenu);var t=this.artRender.artText.get("$eventCenter");this.artRender.artText.get("$eventCenter").attachDOMEvent(document.body,"mousewheel",(function(e){return t.emit("DOM."+e.type)})),this.addDOMEvent("paste",this.paste),this.addDOMEvent("drop",this.drop)},e.prototype.detachAllEvent=function(){for(var e,t=0,n=this.customizeEvents;t<n.length;t++){var r=n[t];(e=this.artRender.artText.get("$eventCenter")).off.apply(e,r)}for(var o=0,i=this.DOMEvents;o<i.length;o++){var s=i[o];this.artRender.artText.get("$eventCenter").detachDOMEvent(s)}this.customizeEvents=[],this.DOMEvents=[],this.artRender.dom.setAttribute("contenteditable","false")},e.prototype.addDOMEvent=function(e,t){var n=this;var r=this.artRender.artText.get("$eventCenter").attachDOMEvent(this.artRender.dom,e,(function(e){return n.artRender.artText.get("$eventCenter").emit("DOM."+e.type),t(e,n)}));this.DOMEvents.push(r)},e.prototype.addCustomizeEvent=function(e,t){this.artRender.artText.get("$eventCenter").on(e,t),this.customizeEvents.push([e,t])},e.prototype.keydown=function(e,t){var n=e.key;if(!t.shortcutKey(e,t.artRender.artText))return!1;if(/^Arrow(Right|Left|Up|Down)$/.test(n)&&t.artRender.cursor.moveCursor(n))return e.preventDefault(),!1;if("Enter"==n){if(!t.artRender.renderRender.render(n,"keydown"))return e.preventDefault(),!1}else if("Backspace"==n&&!t.artRender.renderRender.render(n,"keydown"))return e.preventDefault(),!1;return!0},e.prototype.shortcutKey=function(e,t){if(e.ctrlKey&&66==e.keyCode)!function(e){$(e,"**")}(t);else if(e.ctrlKey&&73==e.keyCode)!function(e){$(e,"*")}(t);else if(e.ctrlKey&&e.shiftKey&&68==e.keyCode)!function(e){$(e,"~~")}(t);else if(e.ctrlKey&&85==e.keyCode)!function(e){$(e,"__")}(t);else if(e.ctrlKey&&e.altKey&&83==e.keyCode)!function(e){$(e,"^")}(t);else if(e.ctrlKey&&e.shiftKey&&83==e.keyCode)!function(e){$(e,"~")}(t);else{if(!e.ctrlKey||77!=e.keyCode)return!0;!function(e){$(e,"==")}(t)}return!1},e.prototype.keyup=function(e,t){var n=e.key;"Backspace"==n&&""==t.artRender.dom.innerHTML&&(t.artRender.dom.innerHTML="<p><br/></p>"),t.isComposition||t.artRender.renderRender.render(n,"keyup")},e.prototype.click=function(e,t){var n=e.target;if(e.altKey&&"A"==n.nodeName)window.open(n.href);else{var r=t.artRender.cursor;r.getSelection(),r.setSelection()}},e.prototype.contextmenu=function(e,t){e.preventDefault(),t.artRender.floatAuxiliaryTool.open(e.clientY,e.clientX)},e.prototype.paste=function(e,t){if(e.clipboardData&&e.clipboardData.items){for(var n=null,r=0,o=e.clipboardData.items.length;r<o;r++){var i=e.clipboardData.items[r];if("string"===i.kind)if("text/plain"==i.type)n=["text/plain",i];else if("text/html"==i.type){n=["text/html",i];break}}if(n&&"text/html"==n[0]){var s=t.getAsString(t.artRender);return n[1].getAsString(s),!1}}},e.prototype.getAsString=function(e){return function(t){var n=document.createElement("html");n.innerHTML=t;var r=n.childNodes[1],o=e.cursor.location;console.log(o);var i=function e(t){var n="";if("DIV"==t.nodeName||"P"==t.nodeName){for(var r=0;r<t.childNodes.length;r++)n+=e(t.childNodes[r]);n+="\n"}else if("UL"==t.nodeName)for(r=0;r<t.childNodes.length;r++)n+="* "+e(t.childNodes[r])+"\n";else if("OL"==t.nodeName)for(r=0;r<t.childNodes.length;r++)n+=(r+1).toString()+". "+e(t.childNodes[r])+"\n";else if("BLOCKQUOTE"==t.nodeName)for(r=0;r<t.childNodes.length;r++)n+="> "+e(t.childNodes[r])+"\n";else if("TABLE"==t.nodeName)for(r=0;r<t.childNodes.length;r++)n+="> "+e(t.childNodes[r])+"\n";else if(/^H\d$/.test(t.nodeName)){n+="#".repeat(parseInt(t.nodeName[1]))+" ";for(r=0;r<t.childNodes.length;r++)n+=e(t.childNodes[r]);n+="\n"}else if("A"==t.nodeName)n+="["+e(t.childNodes[0])+"]("+t.href+")";else if("IMG"==t.nodeName)n+="!["+t.alt+"]("+t.src+")";else if("#text"==t.nodeName)n+=t.data;else{var o=!0;for(r=0;r<Q.length;r++)if(t.nodeName.toLowerCase()==Q[r].tag){n+=Q[r].left;for(var i=0;i<t.childNodes.length;i++)n+=e(t.childNodes[i]);n+=Q[r].right,o=!1;break}for(r=0;o&&r<t.childNodes.length;r++)n+=e(t.childNodes[r])}return n}(r);console.log(i);for(var s=(i=i.replace(/(^\s*)|(\s*$)/g,"")).split("\n"),a=o[2],l=0;l<s.length;l++)0==l?(console.log(a),e.dom.childNodes[a].appendChild(document.createTextNode(s[l])),a++):(console.log(a),e.dom.insertBefore(document.createTextNode(s[l]),e.dom.childNodes[a]),a++)}},e.prototype.drop=function(e,t){e.preventDefault();for(var n=function(n,r){var o=e.dataTransfer.files[n],i=new FileReader;/.*\.md$/.test(o.name)||"text/plain"==o.type?(i.onload=function(){i.result&&t.artRender.artText.get("$editor").openFile({defaultMd:i.result.toString(),name:o.name})},i.readAsText(o)):/^image\/(png|jpe?g)$/.test(o.type)?(i.onload=function(){var n=null;n=t.uploadImg?t.uploadImg(i.result):i.result;var r=new Image;r.src=n;var s=document.createElement("span");s.setAttribute("class","art-hide");var a=document.createTextNode("!["+o.name+"]("+n+")");s.appendChild(a);var l=e.target;l.appendChild(s),l.appendChild(r)},i.readAsDataURL(o)):t.artRender.artText.get("message").create("不支持该文件类型","error")},r=0,o=e.dataTransfer.files.length;r<o;r++)n(r)},e}(),ue=function(){function e(){this.moreDom=null}return e.prototype.createLi=function(e,t){var n=document.createElement("li");n.className="art-floatTool-li",n.innerHTML=e;var r=this;n.onclick=function(){t(r),r.close()},this.moreDom.appendChild(n)},e.prototype.createDom=function(){this.moreDom=document.createElement("ul"),this.moreDom.style.display="none",this.moreDom.setAttribute("class","art-floatTool"),this.createLi("上方插入一行",this.insertUpLine),this.createLi("下方插入一行",this.insertDownLine);var e=document.createElement("li");return e.className="art-divider",this.moreDom.appendChild(e),this.createLi("左边插入一列",this.insertLeftColumn),this.createLi("右边插入一列",this.insertRightColumn),(e=document.createElement("li")).className="art-divider",this.moreDom.appendChild(e),this.createLi("删除行",this.deleteLine),this.createLi("删除列",this.deleteColumn),this.moreDom},e.prototype.insertUpLine=function(e){for(var t,n=e.thtdDom.parentNode,r=-1,o=0;o<n.childNodes.length;o++)if(n.childNodes[o]==e.thtdDom){r=o;break}var i=document.createElement("tr");if(e.tableDom.rows[0]==n){var s=document.createElement("tr");for(o=0;o<n.childNodes.length;o++){var a=document.createElement("th");o==r&&(t=a),i.appendChild(a);for(var l=document.createElement("td"),d=0;d<n.childNodes[o].childNodes.length;d++)l.appendChild(n.childNodes[o].childNodes[d]);s.appendChild(l),(c=n.childNodes[o].getAttribute("style"))&&(a.setAttribute("style",c),l.setAttribute("style",c))}n.parentNode.insertBefore(i,n),n.parentNode.removeChild(n),e.tableDom.rows[1].parentNode.insertBefore(s,e.tableDom.rows[1])}else{for(o=0;o<n.childNodes.length;o++){var c;l=document.createElement("td");o==r&&(t=l),i.appendChild(l),(c=n.childNodes[o].getAttribute("style"))&&l.setAttribute("style",c)}n.parentNode.insertBefore(i,n)}L.setCursor(t,0)},e.prototype.insertDownLine=function(e){for(var t,n=e.thtdDom.parentNode,r=-1,o=0;o<n.childNodes.length;o++)if(n.childNodes[o]==e.thtdDom){r=o;break}var i=document.createElement("tr");for(o=0;o<n.childNodes.length;o++){var s=document.createElement("td");o==r&&(t=s),i.appendChild(s);var a=n.childNodes[o].getAttribute("style");a&&s.setAttribute("style",a)}e.tableDom.rows[e.tableDom.rows.length-1]==n?e.tableDom.childNodes[1].appendChild(i):e.tableDom.rows[0]==n?e.tableDom.rows[1].parentNode.insertBefore(i,e.tableDom.rows[1]):n.parentNode.insertBefore(i,n.nextSibling),L.setCursor(t,0)},e.prototype.insertLeftColumn=function(e){for(var t,n=e.thtdDom.parentNode,r=-1,o=0;o<n.childNodes.length;o++)if(n.childNodes[o]==e.thtdDom){r=o;break}for(o=0;o<e.tableDom.rows.length;o++){var i=void 0;i=0==o?document.createElement("th"):document.createElement("td"),e.tableDom.rows[o]==n&&(t=i),e.tableDom.rows[o].cells[r].parentNode.insertBefore(i,e.tableDom.rows[o].cells[r])}L.setCursor(t,0)},e.prototype.insertRightColumn=function(e){for(var t,n=e.thtdDom.parentNode,r=-1,o=0;o<n.childNodes.length;o++)if(n.childNodes[o]==e.thtdDom){r=o;break}for(o=0;o<e.tableDom.rows.length;o++){var i=void 0;i=0==o?document.createElement("th"):document.createElement("td"),e.tableDom.rows[o]==n&&(t=i),e.tableDom.rows[o].cells[r].nextSibling?e.tableDom.rows[o].cells[r].parentNode.insertBefore(i,e.tableDom.rows[o].cells[r].nextSibling):e.tableDom.rows[o].cells[r].parentNode.appendChild(i)}L.setCursor(t,0)},e.prototype.deleteLine=function(e){for(var t=e.thtdDom.parentNode,n=-1,r=-1,o=0;o<t.childNodes.length;o++)if(t.childNodes[o]==e.thtdDom){n=o;break}for(o=0;o<e.tableDom.rows.length;o++)if(e.tableDom.rows[o]==t){r=o;break}if(t.parentNode.removeChild(t),0==r){console.log("删除th行");var i=document.createElement("tr");for(o=0;o<e.tableDom.rows[0].cells.length;o++){var s=document.createElement("th"),a=e.tableDom.rows[0].cells[o].getAttribute("style");a&&s.setAttribute("style",a),s.innerHTML=e.tableDom.rows[0].cells[o].innerHTML,i.appendChild(s)}e.tableDom.tHead.appendChild(i),e.tableDom.rows[1].parentNode.removeChild(e.tableDom.rows[1])}L.setCursor(e.tableDom.rows[r].cells[n],0)},e.prototype.deleteColumn=function(e){for(var t=e.thtdDom.parentNode,n=-1,r=-1,o=0;o<t.childNodes.length;o++)if(t.childNodes[o]==e.thtdDom){n=o;break}for(o=0;o<e.tableDom.rows.length;o++)e.tableDom.rows[o]==t&&(r=o),e.tableDom.rows[o].cells[n].parentNode.removeChild(e.tableDom.rows[o].cells[n]);L.setCursor(e.tableDom.rows[r].cells[n],0)},e.prototype.open=function(e,t){var n=L.sel,r=n.anchorNode,o=n.anchorOffset;L.setCursor(r,o);for(var i=r;"TR"!=i.parentNode.nodeName&&i.parentNode!=document.body;)i=i.parentNode;"TR"==i.parentNode.nodeName&&(this.thtdDom=i,this.moreDom.style.display="inherit",this.tableDom=t,this.moreDom.style.top=e[1].toString()+"px",this.moreDom.style.left=e[0].toString()+"px")},e.prototype.close=function(){this.moreDom.style.display="none"},e}(),pe=n(8),fe={insert:"head",singleton:!1};a()(pe.a,fe),pe.a.locals;function me(e){for(var t=[],n=[],r=0,o=e.childNodes;r<o.length;r++){var i=o[r];if(/^h\d$/.test(i.nodeName)){var s=i.getMd();s=s.replace(/\s/g,"-").replace(/\\|\/|#|\:/g,"");var a=new X("a",{href:"#"+s},new I(i.getText())),l=new X("p",{class:"art-toc-"+i.nodeName},a);n.push(l)}else i instanceof X&&i.attr.class&&/art-toc(\s|$)/.test(i.attr.class)&&t.push(i)}for(var d=0,c=t;d<c.length;d++){c[d].childNodes=n}}function ge(e,t){if(e.nodeName.toLowerCase()==t.nodeName){if("code"==t.nodeName){for(var n in!e.getAttribute("style")||null!=t.attr.style&&t.attr.class||e.setAttribute("style",""),t.attr)/^__[a-zA-Z\d]+__$/.test(n)||e.setAttribute(n,t.attr[n]);var r=t.getMd();if(xe.plugins.hljs&&"pre"==t.parentNode.nodeName){var o=t.attr.class;o||(o="");var s=o.match(/lang-(.*?)(\s|$)/);if(s&&null!=xe.plugins.hljs.getLanguage(s[1]))r=xe.plugins.hljs.highlight(s[1],r).value;else{var a=xe.plugins.hljs.highlightAuto(r);r=a.value,e.className.match(a.language)||(e.className+=" "+a.language)}}return e.innerHTML=r,null}if(i.b.hasClass(e,"art-shield")){var l=!0;if(t.hasClass("art-flowTool")&&xe.plugins.flowchart&&xe.plugins.Raphael){e.innerHTML="";r=e.previousSibling.innerText;try{xe.plugins.flowchart.parse(r).drawSVG(e),e.previousSibling.style.display="none",e.onclick=function(){i.b.hasClass(this,"art-flowTool")&&(this.previousSibling.style.display="inherit"),L.setCursor(this.previousSibling,0)}}catch(e){console.error("flowchart发生错误"),console.error(e)}}else if("math"==t.attr.__dom__&&xe.plugins.katex){var d=e.childNodes[0].getAttribute("art-math");d&&t.childNodes[0].attr["art-math"]!=d&&(e.childNodes[0].innerHTML=xe.plugins.katex.renderToString(t.childNodes[0].attr["art-math"],{throwOnError:!1}),e.childNodes[0].setAttribute("art-math",t.childNodes[0].attr["art-math"]))}else if("tocTool"==t.attr.__dom__)q(e),l=!1;else if("codeTool"==t.attr.__dom__)P(e,t.attr.__dict__.codeLang),l=!1;else if("tableTool"==t.attr.__dom__)U(e),l=!1;else if(i.b.hasClass(e,"art-toc"))for(var c=0,h=0;c<e.childNodes.length||h<t.childNodes.length;c++,h++)if(c>=e.childNodes.length)e.appendChild(t.childNodes[h].newDom());else if(h>=t.childNodes.length)for(var u=e.childNodes.length;c<u;)e.removeChild(e.lastChild),c++;else ge(e.childNodes[c],t.childNodes[h]);for(var n in!l||!e.getAttribute("style")||null!=t.attr.style&&t.attr.class||e.setAttribute("style",""),t.attr)/^__[a-zA-Z\d]+__$/.test(n)||e.setAttribute(n,t.attr[n])}else{for(var n in!e.getAttribute("style")||null!=t.attr.style&&t.attr.class||e.setAttribute("style",""),t.attr)/^__[a-zA-Z\d]+__$/.test(n)||e.setAttribute(n,t.attr[n]);for(c=0,h=0;c<e.childNodes.length||h<t.childNodes.length;c++,h++)if(c>=e.childNodes.length)e.appendChild(t.childNodes[h].newDom());else if(h>=t.childNodes.length)for(u=e.childNodes.length;c<u;)e.removeChild(e.lastChild),c++;else"#text"==t.childNodes[h].nodeName?"#text"==e.childNodes[c].nodeName.toLowerCase()?t.childNodes[h].text!=e.childNodes[c].nodeValue&&(e.childNodes[c].nodeValue=t.childNodes[h].text):e.replaceChild(t.childNodes[h].newDom(),e.childNodes[c]):ge(e.childNodes[c],t.childNodes[h])}}else e.parentNode.replaceChild(t.newDom(),e);return null}function be(e){return e.rootNode.replaceAllChild(ce(e.rootNode.dom).childNodes),e.vnodeDispose(e.rootNode),ge(e.rootNode.dom,e.rootNode),!1}var ve=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],s=0,a=i.length;s<a;s++,o++)r[o]=i[s];return r},ye=function(){function e(e){this.artRender=e,this.rootNode=new X("div",{__root__:!0,class:"art-render-art"},new X("p",{},new X("br")))}return e.prototype.render=function(e,t){var n=!1;if(this.artRender.cursor.getSelection(),"keydown"==t)switch(e){case"Backspace":n=function(e){var t=e.artRender.cursor.getSelection();if(t)if("PRE"==e.rootNode.dom.childNodes[t.anchorAlineOffset].nodeName){if(null==t.anchorNode.previousSibling&&0==t.anchorInlineOffset)return!1}else console.log("无执行",t);return!0}(this);break;case"Enter":n=function(e){var t=e.artRender.cursor.location,n=e.artRender.cursor.location,r=n.anchorNode,o=n.anchorOffset;if(console.log("enter"),t){e.rootNode.replaceAllChild(ce(e.rootNode.dom).childNodes);var i=e.rootNode.childNodes[t.anchorAlineOffset].getMd(),s=e.rootNode.dom.childNodes[t.anchorAlineOffset];if(/^(\*{3,}$|^\-{3,}$|^\_{3,}$)/.test(i)){var a=document.createElement("hr");return e.rootNode.dom.replaceChild(a,s),L.setCursor(a,0),!1}if(/^\[(TOC)|(toc)\]$/.test(i)){var l=document.createElement("div");l.setAttribute("class","art-shield art-toc"),l.setAttribute("contenteditable","false");var d,c=document.createElement("div");return c.setAttribute("class","art-shield art-tocTool"),c.setAttribute("contenteditable","false"),q(c),(d=document.createElement("p")).innerHTML="<br/>",s.nextSibling?s.parentNode.insertBefore(d,s.nextSibling):s.parentNode.appendChild(d),e.rootNode.dom.replaceChild(l,s),e.rootNode.dom.insertBefore(c,l),me(e.rootNode),L.setCursor(d,0),!1}if(/^\|.*\|/.test(i)){var h=document.createElement("table"),u=document.createElement("thead"),p=document.createElement("tbody");h.appendChild(u),h.appendChild(p),h.style.width="100%";for(var f=document.createElement("tr"),m=document.createElement("tr"),g=i.split("|"),b=1,v=g.length-1;b<v;b++){var y=document.createElement("th");y.innerHTML=g[b],f.appendChild(y),m.appendChild(document.createElement("td"))}return u.appendChild(f),p.appendChild(m),(x=document.createElement("div")).setAttribute("class","art-shield art-tableTool"),x.setAttribute("contenteditable","false"),U(x),e.rootNode.dom.replaceChild(h,e.rootNode.dom.childNodes[t.anchorAlineOffset]),e.rootNode.dom.insertBefore(x,h),L.setCursor(m.childNodes[0],0),!1}if(/^```/.test(i)){var N=document.createElement("pre"),w=document.createElement("code");w.innerHTML="\n";var x,C=i.match(/^```\s*([^\s]*?)\s*$/)[1];if((x=document.createElement("div")).setAttribute("class","art-shield art-codeTool"),x.setAttribute("contenteditable","false"),null!=C&&""!=C){if(w.setAttribute("class","lang-"+C),N.setAttribute("class","art-pre-"+C),"flow"==C){var T=document.createElement("div");T.setAttribute("class","art-shield art-flowTool"),T.setAttribute("art-flow",""),T.setAttribute("contenteditable","false"),e.rootNode.dom.insertBefore(T,e.rootNode.dom.childNodes[t.anchorAlineOffset].nextSibling)}P(x,C)}else P(x);return N.appendChild(w),e.rootNode.dom.replaceChild(N,e.rootNode.dom.childNodes[t.anchorAlineOffset]),e.rootNode.dom.insertBefore(x,N),L.setCursor(w,0),!1}if("BLOCKQUOTE"==r.parentNode.nodeName&&0==o&&"P"==r.nodeName&&1==r.childNodes.length&&"BR"==r.childNodes[0].nodeName)return(d=document.createElement("p")).innerHTML="<br/>",r.parentNode.nextSibling?r.parentNode.parentNode.insertBefore(d,r.parentNode.nextSibling):r.parentNode.parentNode.appendChild(d),r.parentNode.removeChild(r),L.setCursor(d,0),e.artRender.cursor.getSelection(),!1;if("BLOCKQUOTE"==r.parentNode.parentNode.nodeName&&null==r.nextSibling&&o==r.length)return(d=document.createElement("p")).innerHTML="<br/>",r.parentNode.nextSibling?r.parentNode.parentNode.insertBefore(d,r.parentNode.nextSibling):r.parentNode.parentNode.appendChild(d),L.setCursor(d,0),e.artRender.cursor.getSelection(),!1;if(0==o&&"LI"==r.nodeName&&1==r.childNodes.length&&"BR"==r.childNodes[0].nodeName)return(d=document.createElement("p")).innerHTML="<br/>",r.parentNode.nextSibling?r.parentNode.parentNode.insertBefore(d,r.parentNode.nextSibling):r.parentNode.parentNode.appendChild(d),r.parentNode.removeChild(r),L.setCursor(d,0),e.artRender.cursor.getSelection(),!1;if("LI"==r.nodeName)return(d=document.createElement("p")).innerHTML="<br/>",r.parentNode.nextSibling?r.parentNode.parentNode.insertBefore(d,r):r.parentNode.parentNode.appendChild(d),r.parentNode.removeChild(r),L.setCursor(d,0),e.artRender.cursor.getSelection(),!1;if("P"==r.nodeName&&"LI"==r.parentNode.nodeName&&1==r.childNodes.length&&"BR"==r.childNodes[0].nodeName){var A=document.createElement("li");return A.innerHTML="<p><br/></p>",r.parentNode.nextSibling?r.parentNode.parentNode.insertBefore(A,r.parentNode.nextSibling):r.parentNode.parentNode.appendChild(A),r.parentNode.removeChild(r),L.setCursor(A,0),e.artRender.cursor.getSelection(),!1}if("PRE"==s.nodeName){var E=t.anchorNode.nodeValue;return console.log(E),E=E.substring(0,t.anchorOffset)+"\n\r"+E.substring(t.anchorOffset),t.anchorNode.nodeValue=E,L.setCursor(t.anchorNode,t.anchorOffset+1),e.artRender.cursor.getSelection(),!1}console.log("无执行",t)}return!0}(this)}else"keyup"==t&&(n=be(this));return this.artRender.cursor.setSelection(),this.artRender.artText.get("$eventCenter").emit("artRender-render"),n},e.prototype.updateBlockquote=function(e){for(var t=0;t<e.childNodes.length;t++)"blockquote"==e.childNodes[t].nodeName||"ul"==e.childNodes[t].nodeName||"ol"==e.childNodes[t].nodeName?this.vnodeDispose(e.childNodes[t]):/^>\s/.test(e.childNodes[t].getMd())?e.replaceChild(new X("blockquote",{},new X("p",{},new X("br"))),e.childNodes[t]):/^\*\s/.test(e.childNodes[t].getMd())?e.replaceChild(new X("ul",{},new X("li",{},new X("br"))),e.childNodes[t]):/^\d\.\s/.test(e.childNodes[t].getMd())?e.replaceChild(new X("ol",{},new X("li",{},new X("br"))),e.childNodes[t]):e.childNodes[t].replaceAllChild(ee(e.childNodes[t].getMd()))},e.prototype.updataULOL=function(e){for(var t=0,n=e.childNodes;t<n.length;t++){var r=n[t];if((r=r).childNodes.length>1||"p"!=r.childNodes[0].nodeName)for(var o=0,i=r.childNodes;o<i.length;o++){var s=i[o];"p"==s.nodeName?s.replaceAllChild(ee(s.getMd())):this.vnodeDispose(s)}else if(/^>\s/.test(r.getMd()))r.replaceAllChild([new X("blockquote",{},new X("p",{},ee(r.getMd().substring(2))))]),this.artRender.cursor.location.focusInlineOffset-=2,this.artRender.cursor.location.anchorInlineOffset-=2;else if(/^\*\s/.test(r.getMd())){var a=new X("p",{},ee(r.getMd().substring(2)));r.replaceAllChild([new X("ul",{},new X("li",{},a))]),this.artRender.cursor.location.focusInlineOffset-=2,this.artRender.cursor.location.anchorInlineOffset-=2}else if(/^\d\.\s/.test(r.getMd())){a=new X("p",{},ee(r.getMd().substring(2)));r.replaceAllChild([new X("ol",{},new X("li",{},a))]),this.artRender.cursor.location.focusInlineOffset-=3,this.artRender.cursor.location.anchorInlineOffset-=3}else if("ul"==e.nodeName&&/^\[x|X\]\s/.test(r.getMd())){a=new X("p",{},ve([new X("input",{type:"checkbox",checked:"checked"})],ee(r.getMd().substring(4))));r.replaceAllChild([a])}else if("ul"==e.nodeName&&/^\[\s\]\s/.test(r.getMd())){a=new X("p",{},ve([new X("input",{type:"checkbox"})],ee(r.getMd().substring(4))));r.replaceAllChild([a])}else"p"==r.childNodes[0].nodeName&&"input"==r.childNodes[0].childNodes[0].nodeName?r.childNodes[0].replaceAllChild(ve([r.childNodes[0].childNodes[0]],ee(r.childNodes[0].getMd()))):r.replaceAllChild([new X("p",{},ee(r.childNodes[0].getMd()))])}},e.prototype.updateRoot=function(e){for(var t=e.childNodes.length-1;t>=0;t--){var n=this.vnodeDispose(e.childNodes[t]);if(n&&n.length>0){e.removeChild(e.childNodes[t]);for(var r=e.childNodes[t],o=0,i=n;o<i.length;o++){var s=i[o];e.insertBefore(s,r)||e.appendChild(s)}}}me(e)},e.prototype.vnodeDispose=function(e,t){if(void 0===t&&(t=null),null!=t)return e.replaceAllChild(function(e){for(var t,n=e.split("\n"),r=[],o=0,i=n.length;o<i;o++){var s=le(n,o,i);s?(s[0].forEach((function(e){r.push(e)})),(o=s[1])+1<i&&/^\s*$/.test(n[o+1])&&o++):(t=ne(n[o]))?(t.forEach((function(e){r.push(e)})),o+1<i&&/^\s*$/.test(n[o+1])&&o++):(r.push(new X("p",{},ee(n[o]))),o+1<i&&/^\s*$/.test(n[o+1])&&o++)}return r}(t)),me(e),null;if(1==e.attr.__root__)this.updateRoot(e);else{if(e.attr.class&&e.attr.class.match(/art-shield/))return null;if("blockquote"==e.nodeName)this.updateBlockquote(e);else if("ul"==e.nodeName||"ol"==e.nodeName)this.updataULOL(e);else if("table"==e.nodeName)!function(e){for(var t=0;t<e.childNodes.length;t++)for(var n=0;n<e.childNodes[t].childNodes.length;n++)for(var r=e.childNodes[t].childNodes[n],o=0;o<r.childNodes.length;o++)r.childNodes[o].replaceAllChild(ee(r.childNodes[o].getMd()))}(e);else{if("pre"==e.nodeName||"hr"==e.nodeName)return null;var n=e.getMd(),r=null;if(/^>\s/.test(n))e.parentNode.replaceChild(new X("blockquote",{},new X("p",{},ee(n.substring(2)))),e),this.artRender.cursor.location.focusInlineOffset-=2,this.artRender.cursor.location.anchorInlineOffset-=2;else if(/^\*\s/.test(n))e.parentNode.replaceChild(new X("ul",{},new X("li",{},ee(n.substring(2)))),e),this.artRender.cursor.location.focusInlineOffset-=2,this.artRender.cursor.location.anchorInlineOffset-=2;else{if(!/^\d\.\s/.test(n))return(r=ne(n))?r:[new X("p",{},ee(n))];e.parentNode.replaceChild(new X("ol",{},new X("li",{},ee(n.substring(3)))),e),this.artRender.cursor.location.focusInlineOffset-=3,this.artRender.cursor.location.anchorInlineOffset-=3}}}return null},e}(),Ne=window,we=function(){function e(e){this.artText=e,this.cursor=null,this.abbrName=" MD ",this.tableMoreTool=new ue,this.floatAuxiliaryTool=new H,this.renderEvent=new he(this),this.renderRender=new ye(this),this.registerPlugin()}return e.setPlugin=function(t,n,r){void 0===r&&(r=null),e.plugins[t]=n,r&&null!=r.renderRender.render&&r.renderRender.render(null,"keyup")},e.prototype.registerPlugin=function(){var t=this;if("artText-0"!=this.artText.nameId)return null;if(this.artText.options.code.jsFun?e.setPlugin("hljs",this.artText.options.code.jsFun):this.artText.options.code.js&&i.b.loadScript(this.artText.options.code.js,(function(){e.setPlugin("hljs",Ne.hljs,t)})),null!=this.artText.options.math.jsFun?e.setPlugin("katex",this.artText.options.math.jsFun):this.artText.options.math.js&&i.b.loadScript(this.artText.options.math.js,(function(){e.setPlugin("katex",Ne.katex,t)})),this.artText.options.math.css&&i.b.loadCss(this.artText.options.math.css),this.artText.options.flowchart.jsFun)e.setPlugin("flowchart",this.artText.options.flowchart.jsFun);else if(this.artText.options.flowchart.js){i.b.loadScript(this.artText.options.flowchart.js[0],(function(){e.setPlugin("Raphael",Ne.Raphael,null),i.b.loadScript(t.artText.options.flowchart.js[1],(function(){e.setPlugin("flowchart",Ne.flowchart,t)}))}))}},e.prototype.createDom=function(){return this.artText.get("$tool").add({dom:this.tableMoreTool.createDom()}),this.artText.get("$tool").add({dom:this.floatAuxiliaryTool.createDom()}),this.dom=this.renderRender.rootNode.newDom(),this.cursor=new L(this.renderRender.rootNode.dom),this.dom},e.prototype.open=function(){this.dom.style.display="inherit",this.renderEvent.attachAllEvent()},e.prototype.close=function(){this.renderEvent.detachAllEvent(),this.dom.style.display="none"},e.prototype.getMd=function(){be(this.renderRender);for(var e="",t=0;t<this.renderRender.rootNode.childNodes.length;t++){var n=this.renderRender.rootNode.childNodes[t].getMd("read");n&&(e+=n+"\n")}return e},e.prototype.setMd=function(e){this.renderRender.vnodeDispose(this.renderRender.rootNode,e),ge(this.renderRender.rootNode.dom,this.renderRender.rootNode),this.artText.get("$eventCenter").emit("artRender-render")},e.prototype.attachAllEvent=function(){this.renderEvent.attachAllEvent()},e.prototype.detachAllEvent=function(){console.log("sdad",this),this.renderEvent.detachAllEvent()},e.plugins={hljs:null,katex:null,flowchart:null,Raphael:null},e.Name="ArtRender",e}(),xe=we,Ce={install:function(e,t){t.container.bind("$artRender",we,[{get:"art"}],!0)},created:function(e,t){e.get("$editor").addRender("artRender",e.get("$artRender")),e.get("$editor").defaultRender=e.get("$artRender")}},Te=function(){function e(e){this.abbrName="Text",this.DOMEvents=[],this.artText=e}return e.prototype.createDom=function(){return this.dom=document.createElement("textarea"),this.dom.setAttribute("class","art-editor-md"),this.dom.addEventListener("input",(function(e){e.target.style.height=this.scrollHeight+"px"})),this.dom},e.prototype.open=function(){this.dom.style.display="inherit"},e.prototype.close=function(){this.dom.style.display="none"},e.prototype.getMd=function(){return this.dom.value},e.prototype.setMd=function(e){this.dom.value=e,this.dom.style.height=this.dom.scrollHeight+5+"px"},e.prototype.attachAllEvent=function(){var e=this.dom,t=this.artText.get("$eventCenter").attachDOMEvent(this.dom,"input",(function(t){return t.target.style.height=e.scrollHeight+"px"}));this.DOMEvents.push(t)},e.prototype.detachAllEvent=function(){for(var e=0,t=this.DOMEvents;e<t.length;e++){var n=t[e];this.artText.get("$eventCenter").detachDOMEvent(n)}},e}(),Ae={install:function(e,t){t.Tool.addCss(".art-editor-md{width:100%;min-height:200px;border:none;outline:none;resize:none;display:none}"),t.container.bind("textareaRender",Te,[{get:"art"}],!0)},created:function(e,t){e.get("$editor").addRender("textareaRender",e.get("textareaRender"))}},Ee=function(){function e(e){this.dom=document.createElement("div"),this.dom.setAttribute("class","art-outlineSidebar"),this.art=e;var t=this;e.get("$eventCenter").on("artRender-render",(function(){return t.updataToc()}))}return e.prototype.updataToc=function(){this.dom.innerHTML="";for(var e=0,t=this.art.get("$artRender").renderRender.rootNode.childNodes;e<t.length;e++){var n=t[e];if(/^h\d$/.test(n.nodeName)){var r=n.getMd();r=r.replace(/\s/g,"-").replace(/\\|\/|#|\:/g,"");var o=document.createElement("p");o.setAttribute("class","art-outlineSidebar-"+n.nodeName);var i=document.createElement("a");i.href="#"+r,i.innerHTML=n.getText(),o.appendChild(i),this.dom.appendChild(o)}}},e}(),De={install:function(e,t){t.container.bind("outlineSidebar",Ee,[{get:"art"}],!0),t.Tool.addCss(".art-outlineSidebar{height: 100%;overflow: auto;}        .art-outlineSidebar-h1{padding-left: 0.6em;}.art-outlineSidebar-h2{padding-left: 1em;}.art-outlineSidebar-h3{padding-left: 2em;}        .art-outlineSidebar-h4{padding-left: 3em;;}.art-outlineSidebar-h5{padding-left: 4em;;}.art-outlineSidebar-h6{padding-left: 5em;}            .art-outlineSidebar p{margin:0; font-size: 12px;padding-right:5px;}.art-outlineSidebar p:hover{background-color: #eee;}            .art-outlineSidebar a{color: inherit;;text-decoration: none;width: 100%;display: block;padding: 8px 0}                .art-outlineSidebar::-webkit-scrollbar {width: 10px;height:0}            .art-outlineSidebar::-webkit-scrollbar-thumb {background: #ccc;}            ")},created:function(e){e.get("sidebar").add("大纲",e.get("outlineSidebar").dom)}};t.default=r.b;o.b.use(r.a),o.b.use(i.a),o.b.use(h),o.b.use(f),o.b.use(Ce),o.b.use(x),o.b.use(S),o.b.use(De),o.b.use(A),o.b.use(M),o.b.use(Ae)}]);