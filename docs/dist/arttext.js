/*! ArtText v0.0.0 */!function(e){var t={};function l(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,l),n.l=!0,n.exports}l.m=e,l.c=t,l.d=function(e,t,i){l.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},l.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.t=function(e,t){if(1&t&&(e=l(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(l.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)l.d(i,n,function(t){return e[t]}.bind(null,n));return i},l.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return l.d(t,"a",t),t},l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},l.p="",l(l.s=8)}([function(e,t,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(l(5)),n=a(l(10)),o=a(l(6)),s=l(1),d=a(l(2)),r=a(l(3));function a(e){return e&&e.__esModule?e:{default:e}}class h{constructor(e,t={},l=[]){this.nodeName=e,this.attr=t,this.childNodes=l instanceof Array||"string"==typeof l?l:null==l?[]:[l]}getDom(){if("#text"===this.nodeName)return document.createTextNode(this.childNodes);let e=document.createElement(this.nodeName);for(let t in this.attr)if("__dom__"===t)if("math"===this.attr[t]&&window.artText.interpreter.katex){let t=window.artText.interpreter.katex.renderToString(this.attr["art-math"],{throwOnError:!1});e.innerHTML=t}else"tableTool"===this.attr[t]?e.appendChild((0,i.default)()):"imgTool"===this.attr[t]?e.appendChild((0,n.default)()):"codeTool"===this.attr[t]&&e.appendChild((0,o.default)());else/^__[a-zA-Z\d]+__$/.test(t)||e.setAttribute(t,this.attr[t]);return this.childNodes.length>0&&this.childNodes.forEach(t=>{e.appendChild(t.getDom())}),e}hasClass(e,t){return(" "+e.className+" ").indexOf(" "+t+" ")>-1}render(e){if(e.nodeName.toLowerCase()===this.nodeName){if("#text"===e.nodeName)return this.childNodes==e.nodeValue?null:(e.nodeValue=this.childNodes,!1);if("code"==this.nodeName)return null;if(this.hasClass(e,"art-shield")){let t=e.getAttribute("art-math");if(t&&this.attr["art-math"]!==t&&window.artText.interpreter.katex){let t=window.artText.interpreter.katex.renderToString(this.attr["art-math"],{throwOnError:!1});e.innerHTML=t}for(let t in this.attr)/^__[a-zA-Z\d]+__$/.test(t)||e.setAttribute(t,this.attr[t])}else{for(let t in this.attr)/^__[a-zA-Z\d]+__$/.test(t)||e.setAttribute(t,this.attr[t]);for(let t=0,l=0;t<e.childNodes.length||l<this.childNodes.length;t++,l++){let i=null,n=null;if(t<e.childNodes.length&&(i=e.childNodes[t]),l<this.childNodes.length&&(n=this.childNodes[l]),null==i)e.appendChild(n.getDom());else if(null==n){let l=e.childNodes.length;for(;t<l;)e.removeChild(e.lastChild),t++}else this.childNodes[l].render(i)}}}else{let t=this.getDom();e.parentNode.replaceChild(t,e)}return null}getText(){if("class"in this.attr&&("art-shield"==this.attr.class||this.attr.class["art-hide"]))return"";let e="";for(let t=0;t<this.childNodes.lenght;t++)e+=this.childNodes[t].getText()}newNode(e){if("#text"==e.nodeName)return new r.default(e.nodeValue);let t=e.nodeName.toLowerCase(),l=new h(t,{},[]);for(let t=0;t<e.attributes.length;t++){let i=e.attributes[t];l.attr[i.localName]=i.value}for(let t=0;t<e.childNodes.length;t++)l.childNodes.push(this.newNode(e.childNodes[t]));return l}domToNode(e){if(e.nodeName!=this.nodeName){if("#text"==e.nodeName||"#text"==this.nodeName)return this.newNode(e);{let t=e.nodeName.toLowerCase();this.nodeName=t}}if("#text"==this.nodeName)return this.childNodes=e.nodeValue,!1;let t;if(this.attr.__root__&&1==this.attr.__root__);else for(this.attr={},t=0;t<e.attributes.length;t++){let l=e.attributes[t];this.attr[l.localName]=l.value}for(t=0;t<e.childNodes.length;t++)if(t<this.childNodes.length){let l=this.childNodes[t].domToNode(e.childNodes[t]);l&&(this.childNodes[t]=l)}else this.childNodes.push(this.newNode(e.childNodes[t]));return t<this.childNodes.length&&this.childNodes.splice(t,this.childNodes.length-t),null}appendChild(e){this.childNodes.push(e)}replaceChild(e,t){let l=this.childNodes.indexOf(t);-1!=l&&(this.childNodes[l]=e)}getMd(e="editor"){let t="";if("a"==this.nodeName)t+=this.childNodes[0].childNodes;else if("hr"==this.nodeName&&"read"==e)t+="***\n";else if("input"==this.nodeName&&"checkbox"==this.attr.type&&"read"==e)"checked"==this.attr.checked?t+="[x] ":t+="[ ] ";else if("blockquote"==this.nodeName&&"read"==e)for(let l=0;l<this.childNodes.length;l++)t+="> "+this.childNodes[l].getMd(e);else if("ul"==this.nodeName&&"read"==e)for(let l=0;l<this.childNodes.length;l++)t+="* "+this.childNodes[l].getMd(e)+"\n";else if("ol"==this.nodeName&&"read"==e)for(let l=0;l<this.childNodes.length;l++)t+=(l+1).toString()+". "+this.childNodes[l].getMd(e)+"\n";else if("read"==e&&("h1 h2 h3 h4 h5 h6".indexOf(this.nodeName)>=0||"p"==this.nodeName)){for(let l=0;l<this.childNodes.length;l++)t+=this.childNodes[l].getMd(e);t+="\n"}else if("read"==e&&"table"==this.nodeName)for(let l=0;l<this.childNodes.length;l++){let i;for(t+="|",i=0;i<this.childNodes[l].childNodes.length;i++)t+=this.childNodes[l].childNodes[i].getMd(e)+"|";if(t+="\n",0==l){for(t+="|";i--;)t+="---|";t+="\n"}}else if("read"==e&&"pre"==this.nodeName){t+="```";let l=this.childNodes[0].attr.class;l&&(t+=" "+l.substring(5).split(" ")[0]),t+="\n";for(let l=0;l<this.childNodes.length;l++)t+=this.childNodes[l].getMd(e)+"\n";t+="```\n"}else{if(this.attr.class&&"art-shield"==this.attr.class)return"";for(let l=0;l<this.childNodes.length;l++)t+=this.childNodes[l].getMd(e)}return t}dispose(){if(1==this.attr.__root__){for(let e=0;e<this.childNodes.length;e++){if(this.childNodes[e].attr.class&&this.childNodes[e].attr.class.match(/art-shield/))continue;let t=this.childNodes[e].dispose();t&&t.length>0&&this.childNodes.splice(e,1,...t)}if(1!=this.attr.__root__)return this.childNodes}else if("blockquote"==this.nodeName)for(let e=0;e<this.childNodes.length;e++)"blockquote"==this.childNodes[e].nodeName||"ul"==this.childNodes[e].nodeName||"ol"==this.childNodes[e].nodeName?this.childNodes[e].dispose():/^>\s/.test(this.childNodes[e].getMd())?this.childNodes[e]=new h("blockquote",{},new h("p",{},new h("br"))):/^\*\s/.test(this.childNodes[e].getMd())?this.childNodes[e]=new h("ul",{},new h("li",{},new h("br"))):/^\d\.\s/.test(this.childNodes[e].getMd())?this.childNodes[e]=new h("ol",{},new h("li",{},new h("br"))):this.childNodes[e].childNodes=(0,d.default)(this.childNodes[e].getMd());else if("ul"===this.nodeName||"ol"===this.nodeName)for(let e=0;e<this.childNodes.length;e++)if("blockquote"==this.childNodes[e].childNodes[0].nodeName||"ul"==this.childNodes[e].childNodes[0].nodeName||"ol"==this.childNodes[e].childNodes[0].nodeName)for(let t=0;t<this.childNodes[e].childNodes.length;t++)"p"==this.childNodes[e].childNodes[t].nodeName?this.childNodes[e].childNodes[t].childNodes=(0,d.default)(this.childNodes[e].childNodes[t].getMd()):this.childNodes[e].childNodes[t].dispose();else/^>\s/.test(this.childNodes[e].getMd())?this.childNodes[e].childNodes=[new h("blockquote",{},new h("p",{},new h("br")))]:/^\*\s/.test(this.childNodes[e].getMd())?this.childNodes[e].childNodes=[new h("ul",{},new h("li",{},new h("br")))]:/^\d\.\s/.test(this.childNodes[e].getMd())?this.childNodes[e].childNodes=[new h("ol",{},new h("li",{},new h("br")))]:"input"==this.childNodes[e].childNodes[0].nodeName?this.childNodes[e].childNodes=[this.childNodes[e].childNodes[0],...(0,d.default)(this.childNodes[e].getMd())]:/^\[x\]\s/.test(this.childNodes[e].getMd())?this.childNodes[e].childNodes=[new h("input",{type:"checkbox",checked:"checked"}),...(0,d.default)(this.childNodes[e].getMd().substring(4))]:/^\[\s\]\s/.test(this.childNodes[e].getMd())?this.childNodes[e].childNodes=[new h("input",{type:"checkbox"}),...(0,d.default)(this.childNodes[e].getMd().substring(4))]:this.childNodes[e].childNodes=(0,d.default)(this.childNodes[e].getMd());else{if("table"!=this.nodeName){if("pre"===this.nodeName)return null;if("hr"==this.nodeName)return null;return(0,s.textToNode)(this.getMd())}for(let e=0;e<this.childNodes.length;e++)for(let t=0;t<this.childNodes[e].childNodes.length;t++)for(let l=0;l<this.childNodes[e].childNodes[t].childNodes.length;l++){let i=(0,d.default)(this.childNodes[e].childNodes[t].childNodes[l].getMd());this.childNodes[e].childNodes[t].childNodes[l].childNodes=i}}return null}}var c=h;t.default=c},function(e,t,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.textToNode=function(e){if(null==e)return null;let t,l=e.split("\n"),d=[];for(let e=0,r=l.length;e<r;e++)if(/^>\s/.test(l[e])){for(t=[];e<r&&/^>\s/.test(l[e]);)t.push(h(l[e])),e++;e--,d.push(c(new o.default("blockquote",{},t)))}else if(/^\*\s/.test(l[e])){for(t=[];e<r&&/^\*\s/.test(l[e]);)t.push(a(l[e],"ul")),e++;e--,d.push(c(new o.default("ul",{},t)))}else if(/^\d\.\s/.test(l[e])){for(t=[];e<r&&/^\d\.\s/.test(l[e]);)t.push(a(l[e],"ol")),e++;e--,d.push(c(new o.default("ol",{},t)))}else if(/^```\s/.test(l[e])){let i,n=l[e].substring(4),a=!1,h="";for(t=[],i=e+1;i<r;i++){if(/^```$/.test(l[i])){a=!0;break}h+=l[i]+"\n",n?t.push(new o.default("code",{class:"lang-"+n},new s.default(l[i]))):t.push(new o.default("code",{},new s.default(l[i])))}if(a){let t;e=i,t=n?new o.default("code",{class:"lang-"+n},new s.default(h)):new o.default("code",{},new s.default(h)),d.push(new o.default("pre",{style:" margin-top:35px"},t))}else d.push(new o.default("p",{},new s.default(l[e])))}else if(/^\|.*\|/.test(l[e])){let n,s,a,h,c=[];if(e+1<r&&/^\|(\s*-{3,}\s*\|)+/.test(l[e+1])){for(t=[],n=l[e].split("|"),s=1,a=n.length-1;s<a;s++)c.push(new o.default("th",{},(0,i.default)(n[s])));for(t.push(new o.default("thead",{},new o.default("tr",{},c))),e+=2,h=[];e<r&&/^\|.*\|/.test(l[e]);){for(n=l[e].split("|"),c=[],s=1,a=n.length-1;s<a;s++)c.push(new o.default("td",{},(0,i.default)(n[s])));h.push(new o.default("tr",{},c)),e++}e--,t.push(new o.default("tbody",{},h)),d.push(new o.default("table",{style:"width:100%; margin-top:35px"},t))}else d.push(new o.default("p",{},(0,i.default)(l[e])))}else/^(\*{3,}$|^\-{3,}$|^\_{3,}$)/.test(l[e])?d.push(new o.default("hr")):(t=(0,n.default)(l[e]))?t.forEach(e=>{d.push(e)}):(t=(0,i.default)(l[e]),d.push(new o.default("p",{},t)));return d},t.htmlToMd=function e(t){let l="";if("DIV"==t.nodeName||"P"==t.nodeName){for(let i=0;i<t.childNodes.length;i++)l+=e(t.childNodes[i]);l+="\n"}else if("UL"==t.nodeName)for(let i=0;i<t.childNodes.length;i++)l+="* "+e(t.childNodes[i])+"\n";else if("OL"==t.nodeName)for(let i=0;i<t.childNodes.length;i++)l+=(i+1).toString()+". "+e(t.childNodes[i])+"\n";else if("BLOCKQUOTE"==t.nodeName)for(let i=0;i<t.childNodes.length;i++)l+="> "+e(t.childNodes[i])+"\n";else if("TABLE"==t.nodeName)for(let i=0;i<t.childNodes.length;i++)l+="> "+e(t.childNodes[i])+"\n";else if(/^H\d$/.test(t.nodeName)){l+="#".repeat(t.nodeName[1])+" ";for(let i=0;i<t.childNodes.length;i++)l+=e(t.childNodes[i]);l+="\n"}else if("A"==t.nodeName)l+="["+e(t.childNodes[0])+"]("+t.href+")";else if("IMG"==t.nodeName)l+="!["+t.alt+"]("+t.src+")";else if("#text"==t.nodeName)l+=t.data;else{let i=!0;for(let n=0;n<d.inlineRule.length;n++)if(t.nodeName.toLowerCase()==d.inlineRule[n].tag){l+=d.inlineRule[n].left;for(let i=0;i<t.childNodes.length;i++)l+=e(t.childNodes[i]);l+=d.inlineRule[n].right,i=!1;break}for(let n=0;i&&n<t.childNodes.length;n++)l+=e(t.childNodes[n])}return l};var i=r(l(2)),n=r(l(11)),o=r(l(0)),s=r(l(3)),d=l(4);function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t){let l=2;return"ol"==t&&(l=3),""==e.substring(l)?new o.default("li",{},new o.default("br")):"ul"==t&&/^\[x\]\s/.test(e.substring(2))?new o.default("li",{},[new o.default("input",{type:"checkbox",checked:"checked"}),...(0,i.default)(e.substring(6))]):"ul"==t&&/^\[\s\]\s/.test(e.substring(2))?new o.default("li",{},[new o.default("input",{type:"checkbox"}),...(0,i.default)(e.substring(6))]):/^\*\s/.test(e.substring(l))||/^\d\.\s/.test(e.substring(l))?new o.default("li",{},new o.default(t,{},a(e.substring(l),t))):/^>\s/.test(e.substring(2))?new o.default("li",{},new o.default("blockquote",{},h(e.substring(2)))):new o.default("li",{},(0,i.default)(e.substring(l)))}function h(e){return""==e.substring(2)?new o.default("p",{},new o.default("br")):/^>\s/.test(e.substring(2))?new o.default("blockquote",{},h(e.substring(2))):/^\*\s/.test(e.substring(2))?new o.default("ul",{},a(e.substring(2),"ul")):/^\d\.\s/.test(e.substring(2))?new o.default("ol",{},a(e.substring(3),"ol")):new o.default("p",{},(0,i.default)(e.substring(2)))}function c(e){let t=e.childNodes,l=[];for(let e=0;e<t.length;e++)"blockquote"==t[e].nodeName&&l.length>0&&"blockquote"==l[l.length-1].nodeName||"ul"==t[e].nodeName&&l.length>0&&"ul"==l[l.length-1].nodeName||"ol"==t[e].nodeName&&l.length>0&&"ol"==l[l.length-1].nodeName?l[l.length-1].childNodes.push(t[e].childNodes[0]):"ul"==t[e].childNodes[0].nodeName&&l.length>0&&"ul"==l[l.length-1].childNodes[0].nodeName||"ol"==t[e].childNodes[0].nodeName&&l.length>0&&"ol"==l[l.length-1].childNodes[0].nodeName?l[l.length-1].childNodes[0].childNodes.push(t[e].childNodes[0].childNodes[0]):(l.length>0&&("blockquote"==l[l.length-1].nodeName?l[l.length-1]=c(l[l.length-1]):"ul ol".indexOf(l[l.length-1].childNodes[0].nodeName)>=0?l[l.length-1].childNodes[0]=c(l[l.length-1].childNodes[0]):"ul ol".indexOf(l[l.length-1].nodeName)>=0&&(l[l.length-1]=c(l[l.length-1]))),l.push(t[e]));return l.length>0&&("blockquote"==l[l.length-1].nodeName?l[l.length-1]=c(l[l.length-1]):"ul ol".indexOf(l[l.length-1].childNodes[0].nodeName)>=0?l[l.length-1].childNodes[0]=c(l[l.length-1].childNodes[0]):"ul ol".indexOf(l[l.length-1].nodeName)>=0&&(l[l.length-1]=c(l[l.length-1]))),e.childNodes=l,e}},function(e,t,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=l(4),n=s(l(3)),o=s(l(0));function s(e){return e&&e.__esModule?e:{default:e}}var d=function(e){if(""===e)return[new o.default("br")];let t=[new n.default(e)],l=[];for(let e=0;e<i.inlineRule.length;e++){l=[];for(let o=0;o<t.length;o++)if("#text"==t[o].nodeName){let s=t[o].childNodes.match(i.inlineRule[e].re);if(s){let d=t[o].childNodes.length;for(let r=0;r<s.length;r++){let a=t[o].childNodes.indexOf(s[r]);0!==a&&l.push(new n.default(t[o].childNodes.substring(0,a))),i.inlineRule[e].fun(s[r]).forEach(e=>{l.push(e)}),r===s.length-1&&a+s[r].length<d?l.push(new n.default(t[o].childNodes.substring(a+s[r].length))):a+s[r].length<d&&(t[o].childNodes=t[o].childNodes.substring(a+s[r].length))}}else l.push(t[o])}else l.push(t[o]);t=l}return t};t.default=d},function(e,t,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i,n=(i=l(0))&&i.__esModule?i:{default:i};class o extends n.default{constructor(e){super("#text",{},e)}getText(){return this.childNodes}getMd(){return this.childNodes}getDom(){return document.createTextNode(this.childNodes)}}var s=o;t.default=s},function(e,t,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.alineRule=t.inlineRule=void 0;var i=s(l(3)),n=s(l(0)),o=s(l(2));l(1);function s(e){return e&&e.__esModule?e:{default:e}}const d=[{tag:"bi",left:"***",right:"***",re:/(\*{3})([^\*].*?)(\*{3})/g,fun:function(e){let t=new n.default("span",{class:"art-hide"},new i.default("***")),l=new n.default("span",{class:"art-text-double"},new i.default(e.substring(3,e.length-3))),o=new n.default("span",{class:"art-hide"},new i.default("***"));return[new n.default("i",{},new n.default("b",{},[t,l,o]))]}},{tag:"b",left:"**",right:"**",re:/(\*{2})([^\*].*?)(\*{2})/g,fun:function(e){return r(["**",2,e,"**","b"])}},{tag:"mark",left:"==",right:"==",re:/\={2}[^\=].*?\={2}/g,fun:function(e){return r(["==",2,e,"==","mark"])}},{tag:"code",left:"`",right:"`",re:/`[^`]+`/g,fun:function(e){return r(["`",1,e,"`","code"])}},{tag:"i",left:"*",right:"*",re:/(\*)([^\*].*?)(\*)/g,fun:function(e){return r(["*",1,e,"*","i"])}},{tag:"img",left:"![",centre:"](",right:")",re:/!\[.*\]\(.*\)/g,fun:function(e){let t=e.match(/\(.*\)/)[0],l=e.match(/\[.*\]/)[0],o=new n.default("span",{class:"art-hide"},[new n.default("span",{class:"art-shield",__dom__:"imgTool"},[]),new i.default(e)]),s=new n.default("img",{src:t.substring(1,t.length-1),alt:l.substring(1,l.length-1),contenteditable:"false",style:"margin: 0 auto;display: block;"},null);return[o,s]}},{tag:"a",left:"[",centre:"](",right:")",re:/\[.*\]\(.*\)/g,fun:function(e){let t=e.match(/\(.*\)/)[0],l=e.match(/\[.*\]/)[0],o=new n.default("span",{class:"art-hide"},new i.default("[")),s=new n.default("a",{href:t.substring(1,t.length-1),class:"art-text-double",title:"alt+点击",style:"cursor: pointer;"},new i.default(l.substring(1,l.length-1))),d=new n.default("span",{class:"art-hide"},new i.default("]"+t));return[o,s,d]}},{tag:"math",left:"$",right:"$",re:/\$.*?\$/g,fun:function(e){let t=new n.default("span",{class:"art-hide"},new i.default("$")),l=new n.default("span",{class:"art-text-double",style:"position: relative;",contenteditable:"false"},new n.default("span",{class:"art-shield",style:"position: absolute;top: 35px;display: inline-table;",contenteditable:"false",__dom__:"math","art-math":e.substring(1,e.length-1)},null)),o=new n.default("span",{class:"art-hide"},new i.default(e.substring(1,e.length-1)+"$"));return[t,l,o]}},{tag:"del",left:"~~",right:"~~",re:/~{2}.*?~{2}/g,fun:function(e){return r(["~~",2,e,"~~","del"])}},{tag:"ins",left:"__",right:"__",re:/_{2}.*?_{2}/g,fun:function(e){return r(["__",2,e,"__","ins"])}},{tag:"sup",left:"^",right:"^",re:/\^[^\^]+\^/g,fun:function(e){return a(["^",1,e,"^","sup"])}},{tag:"sub",left:"~",right:"~",re:/~[^~]+~/g,fun:function(e){return a(["~",1,e,"~","sub"])}}];function r(e){return[new n.default("span",{class:"art-hide"},new i.default(e[0])),new n.default(e[4],{class:"art-text-double"},new i.default(e[2].substring(e[1],e[2].length-e[1]))),new n.default("span",{class:"art-hide"},new i.default(e[3]))]}function a(e){let t=new n.default("span",{class:"art-hide"},new i.default(e[0])),l=new n.default("span",{class:"art-text-double"},new i.default(e[2].substring(e[1],e[2].length-e[1]))),o=new n.default("span",{class:"art-hide"},new i.default(e[3]));return[new n.default(e[4],{},[t,l,o])]}t.inlineRule=d;const h=[{first:"#",last:"",re:/^#\s/,fun:function(e){let t=[new n.default("span",{class:"art-hide"},new i.default("# ")),...(0,o.default)(e.substring(2))];return[new n.default("h1",{},t)]}},{first:"##",last:"",re:/^##\s/,fun:function(e){let t=[new n.default("span",{class:"art-hide"},new i.default("## ")),...(0,o.default)(e.substring(3))];return[new n.default("h2",{},t)]}},{first:"###",last:"",re:/^###\s/,fun:function(e){let t=[new n.default("span",{class:"art-hide"},new i.default("### ")),...(0,o.default)(e.substring(4))];return[new n.default("h3",{},t)]}},{first:"####",last:"",re:/^####\s/,fun:function(e){let t=[new n.default("span",{class:"art-hide"},new i.default("#### ")),...(0,o.default)(e.substring(5))];return[new n.default("h4",{},t)]}},{first:"#####",last:"",re:/^#####\s/,fun:function(e){let t=[new n.default("span",{class:"art-hide"},new i.default("##### ")),...(0,o.default)(e.substring(6))];return[new n.default("h5",{},t)]}},{first:"######",last:"",re:/^######\s/,fun:function(e){let t=[new n.default("span",{class:"art-hide"},new i.default("###### ")),...(0,o.default)(e.substring(7))];return[new n.default("h6",{},t)]}}];t.alineRule=h},function(e,t,l){"use strict";function i(e){return e?[e.rows.length,e.rows.item(0).cells.length]:[0,0]}function n(e){let t=e.target.parentNode.parentNode;if(t.nextSibling&&"TABLE"==t.nextSibling.nodeName)if("none"===e.target.nextSibling.style.display){e.target.nextSibling.style.display="inline";let l=i(t.nextSibling);e.target.nextSibling.childNodes[0].value=l[0],e.target.nextSibling.childNodes[1].value=l[1]}else!function(e,t){if(t[0]=parseInt(t[0]),t[1]=parseInt(t[1]),-1==t[0]||-1==t[1])return null;let l=i(e);if(console.log(l,t),t[0]!=l[0])if(t[0]<l[0])for(let i=l[0]-1;i>t[0]-1;i--)e.rows[i].parentNode.removeChild(e.rows[i]);else for(let i=t[0]-l[0];i>0;i--){let t=document.createElement("tr");for(let e=0;e<l[1];e++){let e=document.createElement("td");t.appendChild(e)}e.appendChild(t)}if(t[1]!=l[1])if(t[1]<l[1])for(let i=l[1]-1;i>t[1]-1;i--)for(let t=0;t<e.rows.length;t++)console.log(e.rows[t].cells[i]),e.rows[t].cells[i].parentNode.removeChild(e.rows[t].cells[i]);else for(let i=t[1]-l[1];i>0;i--)for(let t=0;t<e.rows.length;t++)e.rows[t].appendChild(document.createElement("td"))}(t.nextSibling,[e.target.nextSibling.childNodes[0].value,e.target.nextSibling.childNodes[1].value]),e.target.nextSibling.style.display="none"}function o(e){let t=e.target.parentNode.parentNode;t.nextSibling&&"TABLE"==t.nextSibling.nodeName&&(t.parentNode.removeChild(t.nextSibling),t.parentNode.removeChild(t))}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){let e=document.createElement("div");e.style.width="100%",e.className="art-tableTool art-shield",e.style.fontSize="14px",e.style.position="relative",e.style.top="8px",e.style.height="0",e.setAttribute("contenteditable","false");let t=document.createElement("input");t.style.width="28px",t.style.height="18px",t.style.marginRight="7px",t.style.marginLeft="7px",t.title="调整行";let l=document.createElement("input");l.style.width="28px",l.style.height="18px",l.style.marginRight="7px",l.title="调整列";let i=document.createElement("span");i.style.width="30px",i.innerHTML='<svg class="icon" style="width: 18px; height: 18px;vertical-align: middle;fill: currentColor;overflow: hidden;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1283"><path d="M64.021106 512c0-17.672498 14.07353-31.998785 31.887244-31.998785h832.182277c17.6111 0 31.887244 14.202467 31.887244 31.998785 0 17.672498-14.07353 31.998785-31.887244 31.998785H95.909373c-17.6111 0-31.888268-14.20349-31.888267-31.998785zM959.977871 352.007099c0 17.672498-14.326287 31.998785-31.998785 31.998785s-31.998785-14.326287-31.998785-31.998785V160.016437c0-17.672498-14.326287-31.998785-31.998784-31.998785H160.016437c-17.672498 0-31.998785 14.326287-31.998785 31.998785v191.990662c0 17.672498-14.326287 31.998785-31.998785 31.998785s-31.998785-14.326287-31.998785-31.998785V160.016437c0-53.016471 42.97886-95.995331 95.995332-95.995331H863.981517c53.016471 0 95.995331 42.97886 95.995331 95.995331v191.990662z m0 319.984779v191.990662c0 53.016471-42.97886 95.995331-95.995331 95.995331H160.016437c-53.016471 0-95.995331-42.97886-95.995331-95.995331V671.991878c0-17.672498 14.326287-31.998785 31.998785-31.998785s31.998785 14.326287 31.998784 31.998785v191.990662c0 17.672498 14.326287 31.998785 31.998785 31.998785h703.966103c17.672498 0 31.998785-14.326287 31.998785-31.998785V671.991878c0-17.672498 14.326287-31.998785 31.998785-31.998785s31.996738 14.32731 31.996738 31.998785z" p-id="1284"></path></svg>',i.title="调整大小",i.style.cursor="pointer",i.onclick=n;let s=document.createElement("span");s.appendChild(t),s.appendChild(l),s.style.display="none",i.appendChild(s);let d=document.createElement("span");return d.innerHTML='<svg class="icon" style="width: 18px; height: 18px;color: red;vertical-align: middle;fill: currentColor;overflow: hidden;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="689"><path d="M800.162002 316.659033c1.850138-17.575284 17.596773-30.322609 35.172058-28.473495 17.575284 1.850138 30.322609 17.596773 28.473494 35.172058l-57.966202 550.673811c-5.143137 48.856731-46.341445 85.946464-95.467306 85.946464H313.625954c-49.126884 0-90.325192-37.089733-95.468329-85.946464L160.192446 323.358619c-1.850138-17.575284 10.898211-33.32192 28.472471-35.172057 17.575284-1.850138 33.32192 10.898211 35.172058 28.473494l57.965179 550.672788c1.714038 16.285918 15.446807 28.64848 31.822776 28.648481h396.74707c16.375969 0 30.108738-12.363585 31.822776-28.648481l57.967226-550.673811z m-192.176904 99.345636c17.672498 0 31.998785 14.326287 31.998785 31.998785v223.989447c0 17.672498-14.326287 31.998785-31.998785 31.998785s-31.998785-14.326287-31.998785-31.998785V448.00243c0-17.671475 14.326287-31.997762 31.998785-31.997761z m-191.990662 0c17.672498 0 31.998785 14.326287 31.998785 31.998785v223.989447c0 17.672498-14.326287 31.998785-31.998785 31.998785s-31.998785-14.326287-31.998785-31.998785V448.00243c0-17.671475 14.326287-31.997762 31.998785-31.997761z m-31.998785-223.989447h255.987209v-47.998178c0-8.836249-7.163143-15.999392-15.999393-15.999392H399.995043c-8.836249 0-15.999392 7.163143-15.999392 15.999392v47.998178z m-63.996546 0V128.018675c0-35.344996 28.652574-63.996546 63.997569-63.996546h255.987209c35.343973 0 63.996546 28.652574 63.996546 63.996546v63.996547h223.99968c17.672498 0 31.998785 14.326287 31.998785 31.998785s-14.326287 31.998785-31.998785 31.998784H96.019891c-17.672498 0-31.998785-14.326287-31.998785-31.998784s14.326287-31.998785 31.998785-31.998785h223.979214z" p-id="690"></path></svg>',d.title="删除表格",d.style.position="absolute",d.style.right="0",d.style.cursor="pointer",d.onclick=o,e.appendChild(i),e.appendChild(d),e}},function(e,t,l){"use strict";function i(e){console.log(e,this);let t=e.target.parentNode.parentNode;if(t&&"PRE"==t.nextSibling.nodeName)if(console.log(e.target.nextSibling),"none"===e.target.nextSibling.style.display){e.target.nextSibling.style.display="inline";let l=function(e){let t="";return t=e.childNodes[0].className.substring(5).split(" ")[0],t}(t.nextSibling);e.target.nextSibling.value=l}else!function(e,t){for(let l=0;l<e.childNodes.length;l++)e.childNodes[l].className="lang-"+t}(t.nextSibling,e.target.nextSibling.value),e.target.nextSibling.style.display="none"}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){let e=document.createElement("div");e.style.width="100%",e.className="art-codeTool art-shield",e.style.fontSize="14px",e.style.position="relative",e.style.top="8px",e.style.height="0",e.setAttribute("contenteditable","false");let t=document.createElement("span");t.innerHTML='<svg class="icon" style="width: 18px; height: 18px;vertical-align: middle;fill: currentColor;overflow: hidden;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="714"><path d="M288.010553 735.989447h383.981325c17.672498 0 31.998785 14.326287 31.998784 31.998785s-14.326287 31.998785-31.998784 31.998785H288.010553c-17.672498 0-31.998785-14.326287-31.998785-31.998785s14.326287-31.998785 31.998785-31.998785z m0-159.992901h191.990662c17.672498 0 31.998785 14.326287 31.998785 31.998785s-14.326287 31.998785-31.998785 31.998785H288.010553c-17.672498 0-31.998785-14.326287-31.998785-31.998785s14.326287-31.998785 31.998785-31.998785zM636.111692 92.137467l231.753272 231.753271a95.994308 95.994308 0 0 1 28.116361 67.87897v472.212832c0 53.016471-42.97886 95.995331-95.995332 95.995331H224.014007c-53.016471 0-95.995331-42.97886-95.995332-95.995331V160.016437c0-53.016471 42.97886-95.995331 95.995332-95.995331h344.218715c25.459858 0 49.875944 10.114358 67.87897 28.116361z m-28.116361 62.388932v197.4807h197.4807L607.995331 154.526399z m-53.016471-26.507724H224.014007c-17.672498 0-31.998785 14.326287-31.998785 31.998785v703.966103c0 17.672498 14.326287 31.998785 31.998785 31.998785h575.971986c17.672498 0 31.998785-14.326287 31.998785-31.998785V405.024593v10.980076H607.995331c-35.344996 0-63.996546-28.652574-63.996546-63.996547V128.018675h10.980075z" p-id="715"></path></svg>',t.onclick=i,t.style.cursor="pointer";let l=document.createElement("input");return l.style.width="80px",l.style.height="20px",l.style.marginLeft="7px",l.title="代码语言",l.style.display="none",t.appendChild(l),e.appendChild(t),e}},function(e,t,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadScript=function(e,t){var l=document.createElement("script");l.type="text/javascript",void 0!==t&&(l.readyState?l.onreadystatechange=function(){"loaded"!=l.readyState&&"complete"!=l.readyState||(l.onreadystatechange=null,t())}:l.onload=function(){t()});l.src=e,document.body.appendChild(l)},t.loadCss=function(e){var t=document.createElement("link");t.rel="stylesheet",t.type="text/css",t.href=e,document.getElementsByTagName("head")[0].appendChild(t)},t.addCss=function(e){var t=document.head||document.getElementsByTagName("head")[0],l=document.createElement("style");l.type="text/css",l.styleSheet?l.styleSheet.cssText=e:l.appendChild(document.createTextNode(e));t.appendChild(l)}},function(e,t,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=d(l(9)),n=d(l(12)),o=d(l(14)),s=d(l(15));function d(e){return e&&e.__esModule?e:{default:e}}class r{static use(e,t={}){this.plugins.push({plugin:e,options:t})}constructor(e,t={}){window.artText=this,this.container=e,this.config=new o.default(t),this.interpreter=new n.default(e,this),this.tool=new s.default(e,this),this.event=new i.default(e,this.interpreter.rootDom)}init(){this.registerPlugin(),this.interpreter.init(this.config.model),"read"!=this.config.model&&(this.tool.init(),this.event.init())}registerPlugin(){for(let e=0;e<r.plugins.length;e++)"uploadImg"==r.plugins[e].plugin.name&&(this.event.onUploadImg=r.plugins[e].plugin)}}r.plugins=[],window.ArtText=r;var a=r;t.default=a},function(e,t,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=l(1);class n{constructor(e,t){this.container=e,this.rootDom=t,this.onUploadImg=null}init(){console.log(this.rootDom),this.rootDom.onkeydown=this.onkeydown,this.rootDom.onkeyup=this.onkeyup,this.rootDom.onfocus=this.onfocus,this.rootDom.onblur=this.onblur,this.rootDom.addEventListener("compositionstart",(function(e){n.isComposition=!0}),!1),this.rootDom.addEventListener("compositionend",(function(e){n.isComposition=!1}),!1),this.rootDom.onclick=this.onclick,this.rootDom.onpaste=this.onpaste,this.rootDom.ondrop=this.ondrop,this.rootDom.oncontextmenu=this.oncontextmenu}onfocus(e){}onblur(e){}onpaste(e){if(!e.clipboardData||!e.clipboardData.items)return;let t=null;for(let l=0,i=e.clipboardData.items.length;l<i;l++){let i=e.clipboardData.items[l];if("string"===i.kind)if("text/plain"==i.type)t=["text/plain",i];else if("text/html"==i.type){t=["text/html",i];break}}return t&&"text/html"==t[0]?(t[1].getAsString(e=>{let t=document.createElement("html");t.innerHTML=e;let l=t.childNodes[1];console.log(l);let n=window.artText.interpreter.location;console.log(n);let o=(0,i.htmlToMd)(l);console.log(o),o=o.replace(/(^\s*)|(\s*$)/g,"");let s=o.split("\n"),d=n[2];for(let e=0;e<s.length;e++)0==e?(console.log(d),window.artText.event.rootDom.childNodes[d].appendChild(document.createTextNode(s[e])),d++):(console.log(d),window.artText.event.rootDom.insertBefore(document.createTextNode(s[e]),window.artText.event.rootDom.childNodes[d]),d++)}),!1):void 0}ondrag(e){e.dataTransfer.setData("Text",e.target.id)}ondrop(e){e.preventDefault();for(var t=0,l=e.dataTransfer.files.length;t<l;t++){var i=e.dataTransfer.files[t],n=new FileReader;n.readAsDataURL(i),n.onload=function(){console.log("文件中的数据读取完成");let t=null;t=window.artText.event.onUploadImg?window.artText.event.onUploadImg(n.result):n.result,console.log(t);var l=new Image;l.src=t,console.log(l);let o=document.createElement("span");o.setAttribute("class","art-hide");let s=document.createTextNode("!["+i.name+"]("+t+")");o.appendChild(s),e.target.appendChild(o),e.target.appendChild(l)}}}onclick(e){let t=e.target;window.artText.interpreter.onclick("left"),t&&e.altKey&&"A"==t.nodeName&&window.open(t.href)}oncontextmenu(e){e.preventDefault();let t=e.target;window.artText.interpreter.onclick("right"),t&&e.altKey&&"A"==t.nodeName&&window.open(t.href)}onkeydown(e){if(13==e.keyCode)return window.artText.interpreter.enterRender()}onkeyup(e){let t=window.artText.event;8===e.keyCode&&""===t.container.innerHTML&&(t.container.innerHTML="<div><p><br/></p></div>"),n.isComposition||window.artText.interpreter.render()}}n.isComposition=!1;var o=n;t.default=o},function(e,t,l){"use strict";function i(e){console.log(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){let e=document.createElement("span");return e.style.fontSize="14px",e.setAttribute("contenteditable","false"),e.innerHTML='<svg class="icon" style="width: 19px; height: 19px;vertical-align: middle;fill: currentColor;overflow: hidden;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1140"><path d="M288.010553 448.00243c-35.344996 0-63.996546-28.652574-63.996546-63.996546s28.652574-63.996546 63.996546-63.996546c35.344996 0 63.996546 28.652574 63.996546 63.996546s-28.65155 63.996546-63.996546 63.996546z m639.969556 302.169018l-258.988565-258.077823L372.528482 759.740384c-12.629645 11.402701-31.975249 10.92584-44.027749-1.084705L220.383316 650.927119l-124.363425 100.357686v80.699973c0 17.672498 14.326287 31.998785 31.998784 31.998785h767.96265c17.672498 0 31.998785-14.326287 31.998784-31.998785v-81.81333z m0-90.346681V192.015222c0-17.672498-14.326287-31.998785-31.998784-31.998785H128.018675c-17.672498 0-31.998785 14.326287-31.998784 31.998785v477.033627l84.173074-67.926042c25.424042-20.516266 62.219063-18.58938 85.361133 4.469801l86.61673 86.306668 273.934976-247.308549c25.261337-22.805402 63.951521-21.851681 88.058569 2.170433l213.815736 213.063607zM32.023344 736.273926a45.762253 45.762253 0 0 1 0-0.530072V192.015222c0-53.016471 42.97886-95.995331 95.995331-95.995331h767.96265c53.016471 0 95.995331 42.97886 95.995331 95.995331v639.969556c0 53.016471-42.97886 95.995331-95.995331 95.995331H128.018675c-53.016471 0-95.995331-42.97886-95.995331-95.995331v-95.710852z" p-id="1141"></path></svg>',e.style.cursor="pointer",e.onclick=i,e}},function(e,t,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=l(4),n=s(l(2)),o=s(l(0));function s(e){return e&&e.__esModule?e:{default:e}}var d=function(e){if(""===e)return[new o.default("p",{},new o.default("br"))];for(let t=0;t<i.alineRule.length;t++)if(e.match(i.alineRule[t].re))return i.alineRule[t].fun(e);let t=(0,n.default)(e);return[new o.default("p",{},t)]};t.default=d},function(e,t,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=l(1),n=a(l(6)),o=a(l(5)),s=l(7),d=a(l(0)),r=l(13);function a(e){return e&&e.__esModule?e:{default:e}}var h=class{constructor(e,t){this.artText=t,this.container=e,this.location=null,this.rootNode=this.createRootNode(),this.rootDom=this.container.childNodes[0].childNodes[0],this.sel=window.getSelection(),this.hljs=null,this.katex=null,this.rootTextarea=this.container.childNodes[0].childNodes[1],this.editor=this.container.childNodes[0],this.textarea=null}createRootNode(){let e=new d.default("br"),t=new d.default("p",{},e),l=new d.default("div",{__root__:!0,contenteditable:"true",class:"art-editor-html"},t);return this.container.innerHTML='<div class="art-editor"><div class="art-editor-html"><p><br/></p></div><div class="art-editor-md"></div></div>',this.rootDom=this.container.childNodes[0].childNodes[0],this.rootTextarea=this.container.childNodes[0].childNodes[1],this.editor=this.container.childNodes[0],this.rootDom.style.outline="none",this.rootDom.style.whiteSpace="pre-wrap",this.rootDom.style.wordBreak="break-all",this.editor.style.boxShadow="0 2px 12px 0 rgba(0, 0, 0, 0.1)",this.editor.style.padding="30px 25px",this.editor.style.backgroundColor=this.artText.config.theme.backgroundColor,this.editor.style.borderRadius="4px",l}init(e){"read"==e?(this.rootNode.attr.contenteditable="false",this.rootDom.setAttribute("contenteditable",!1)):(this.textarea=document.createElement("textarea"),this.textarea.style.width="100%",this.textarea.style.minHeight="200px",this.textarea.style.border="none",this.textarea.style.outline="none",this.textarea.style.resize="none",this.textarea.style.display="none",this.textarea.addEventListener("input",(function(e){e.target.style.height="auto",e.target.style.height=this.scrollHeight+"px"})),this.rootTextarea.appendChild(this.textarea)),(0,s.addCss)(r.css),this.artText.config.hljs.jsFun?this.hljs=this.artText.config.hljs.jsFun:this.artText.config.hljs.js&&(0,s.loadScript)(this.artText.config.hljs.js,()=>{window.artText.interpreter.hljs=hljs,hljs.initHighlighting.called=!1,hljs.initHighlighting()}),this.artText.config.katex.jsFun?this.katex=this.artText.config.katex.jsFun:this.artText.config.katex.js&&(0,s.loadScript)(this.artText.config.katex.js,()=>{window.artText.interpreter.katex=katex}),this.artText.config.katex.cssFun||this.artText.config.katex.css&&(0,s.loadCss)(this.artText.config.katex.css),this.setMd(window.artText.config.md)}hasClass(e,t){return(" "+e.className+" ").indexOf(" "+t+" ")>-1}onclick(e="left"){this.location=this.getSelection(),"right"==e?this.artText.tool.setFloatAuxiliaryTool(this.sel):this.artText.tool.setFloatAuxiliaryTool(),this.setSelection()}enterRender(){let e=this.getSelection();if(e){let t=this.rootNode.childNodes[e[2]].getMd(),l=this.rootNode.childNodes[e[2]];if(console.log(e,l),/^(\*{3,}$|^\-{3,}$|^\_{3,}$)/.test(t)){let t=document.createElement("p");t.innerHTML="<br/>",this.rootDom.replaceChild(document.createElement("hr"),this.rootDom.childNodes[e[2]]);let l=this.sel.getRangeAt(0).cloneRange();return l.setStart(t,0),l.collapse(!0),this.sel.removeAllRanges(),this.sel.addRange(l),!1}if(/^\|.*\|/.test(t)){let l=document.createElement("table"),i=document.createElement("thead"),n=document.createElement("tbody");l.appendChild(i),l.appendChild(n),l.style.width="100%",l.style.marginTop="35px";let o=document.createElement("tr"),s=document.createElement("tr"),d=t.split("|");for(let e=1,t=d.length-1;e<t;e++){let t=document.createElement("th");t.innerHTML=d[e],o.appendChild(t),s.appendChild(document.createElement("td"))}i.appendChild(o),n.appendChild(s),this.rootDom.replaceChild(l,this.rootDom.childNodes[e[2]]);let r=this.sel.getRangeAt(0).cloneRange();return r.setStart(s.childNodes[0],0),r.collapse(!0),this.sel.removeAllRanges(),this.sel.addRange(r),!1}if(/^```\s?/.test(t)||/^```\s\S+/.test(t)){let l=document.createElement("pre"),i=document.createElement("code");if(i.innerHTML="<br/>",/^```\s\S+/.test(t)){let e=t.substring(4);i.setAttribute("class","lang-"+e)}l.appendChild(i),this.rootDom.replaceChild(l,this.rootDom.childNodes[e[2]]);let n=this.sel.getRangeAt(0).cloneRange();return n.setStart(i.childNodes[0],0),n.collapse(!0),this.sel.removeAllRanges(),this.sel.addRange(n),!1}if("BLOCKQUOTE"==e[4][1].parentNode.nodeName&&0==e[4][0]&&"P"==e[4][1].nodeName&&1==e[4][1].childNodes.length&&"BR"==e[4][1].childNodes[0].nodeName){let t=e[4][1],l=document.createElement("p");l.innerHTML="<br/>",t.parentNode.nextSibling?t.parentNode.parentNode.insertBefore(l,t.parentNode.nextSibling):t.parentNode.parentNode.appendChild(l),t.parentNode.removeChild(t);let i=this.sel.getRangeAt(0).cloneRange();return i.setStart(l,0),i.collapse(!0),this.sel.removeAllRanges(),this.sel.addRange(i),console.log("无执行2221"),!1}if("BLOCKQUOTE"==e[4][1].parentNode.parentNode.nodeName&&null==e[4][1].nextSibling&&e[4][0]==e[4][1].length){let t=e[4][1],l=document.createElement("p");l.innerHTML="<br/>",t.parentNode.nextSibling?t.parentNode.parentNode.insertBefore(l,t.parentNode.nextSibling):t.parentNode.parentNode.appendChild(l);let i=this.sel.getRangeAt(0).cloneRange();return i.setStart(l,0),i.collapse(!0),this.sel.removeAllRanges(),this.sel.addRange(i),console.log("无执行2226"),!1}if(0==e[4][0]&&"LI"==e[4][1].nodeName&&1==e[4][1].childNodes.length&&"BR"==e[4][1].childNodes[0].nodeName){let t=e[4][1],l=document.createElement("p");l.innerHTML="<br/>",t.parentNode.nextSibling?t.parentNode.parentNode.insertBefore(l,t.parentNode.nextSibling):t.parentNode.parentNode.appendChild(l),t.parentNode.removeChild(t);let i=this.sel.getRangeAt(0).cloneRange();return i.setStart(l,0),i.collapse(!0),this.sel.removeAllRanges(),this.sel.addRange(i),console.log("无执行2226"),!1}if("P"==e[4][1].parentNode.nodeName&&"LI"==e[4][1].parentNode.parentNode.nodeName){let t=e[4][1],l=document.createElement("p");l.innerHTML="<br/>",t.parentNode.nextSibling?t.parentNode.parentNode.insertBefore(l,t.parentNode.nextSibling):t.parentNode.parentNode.appendChild(l);let i=this.sel.getRangeAt(0).cloneRange();return i.setStart(l,0),i.collapse(!0),this.sel.removeAllRanges(),this.sel.addRange(i),console.log("无执行2225"),!1}if("P"==e[4][1].nodeName&&"LI"==e[4][1].parentNode.nodeName&&1==e[4][1].childNodes.length&&"BR"==e[4][1].childNodes[0].nodeName){let t=e[4][1],l=document.createElement("li");l.innerHTML="<br/>",t.parentNode.nextSibling?t.parentNode.parentNode.insertBefore(l,t.parentNode.nextSibling):t.parentNode.parentNode.appendChild(l),t.parentNode.removeChild(t);let i=this.sel.getRangeAt(0).cloneRange();return i.setStart(l,0),i.collapse(!0),this.sel.removeAllRanges(),this.sel.addRange(i),console.log("无执行222"),!1}if("pre"==l.nodeName){let t="\n\r",l=e[4][1].data;console.log(l),l=l.substring(0,e[4][0])+t+l.substring(e[4][0]),e[4][1].data=l;let i=this.sel.getRangeAt(0).cloneRange();return i.setStart(e[4][1],e[4][0]+1),i.collapse(!0),this.sel.removeAllRanges(),this.sel.addRange(i),console.log("无执行222"),!1}console.log("无执行",l)}return!0}render(){let e=this.getSelection();this.location=e,this.rootNode.domToNode(this.rootDom),this.rootNode.dispose(),this.artText.config.renderFlag&&(this.rootNode.render(this.rootDom),this.hljs&&this.location&&"PRE"==this.rootDom.childNodes[this.location[2]].nodeName&&(this.hljs.initHighlighting.called=!1,this.hljs.initHighlighting())),this.setSelection()}getSelection(){let{anchorNode:e,anchorOffset:t,focusNode:l,focusOffset:i}=this.sel;if(e&&l){let n=e,o=t;if(n==this.rootDom)return null;for(;n.parentNode!=this.rootDom;){for(;n.previousSibling;)n=n.previousSibling,o+=n.textContent.length;n=n.parentNode}let s=l,d=i;for(;s.parentNode!==this.rootDom;){for(;s.previousSibling;)s=s.previousSibling,d+=s.textContent.length;s=s.parentNode}let r=-1;for(let e=0;e<this.rootDom.childNodes.length;e++)if(this.rootDom.childNodes[e]===n){r=e;break}let a=-1;for(let e=0;e<this.rootDom.childNodes.length;e++)if(this.rootDom.childNodes[e]===s){a=e;break}let h=e.parentNode.nodeName;return 0!=t||null!=e.previousSibling||"LI"!=h&&"P"!=h&&"TH"!=h&&"TD"!=h||(e=e.parentNode),[o,d,r,a,[t,e]]}return null}searchNode(e,t){if(1===e.childNodes.length&&"#text"===e.childNodes[0].nodeName)return t<=e.childNodes[0].textContent.length?[e.childNodes[0],t]:[e.childNodes[0],t-e.textContent.length];for(let l=0;l<e.childNodes.length;l++){if(!(e.childNodes[l].textContent.length<t))return"#text"===e.childNodes[l].nodeName?[e.childNodes[l],t]:this.searchNode(e.childNodes[l],t);t-=e.childNodes[l].textContent.length}return null}setTool(e){"PRE"==e.nodeName?this.hasClass(e.previousSibling,"art-codeTool")||e.parentNode.insertBefore((0,n.default)(),e):"TABLE"==e.nodeName&&(this.hasClass(e.previousSibling,"art-tableTool")||e.parentNode.insertBefore((0,o.default)(),e))}setSelection(){let e=this.container.getElementsByClassName("art-show");for(let t=e.length-1;t>=0;t--){let l=e[t].getAttribute("class");l=l.replace("art-show","art-hide"),e[t].setAttribute("class",l)}if(this.location&&this.location[2]>=0&&this.location[0]==this.location[1]&&this.location[2]==this.location[3]){let e=null;var t=this.rootDom.childNodes[this.location[2]],l=this.location[0];if(this.setTool(t),e=this.location[4]?-1===this.location[4]||"LI"!==this.location[4][1].nodeName&&"TH"!==this.location[4][1].nodeName&&"P"!==this.location[4][1].nodeName&&"TD"!==this.location[4][1].nodeName&&"DIV"!==this.location[4][1].nodeName?0==this.location[4][0]&&("CODE"==this.location[4][1].parentNode.nodeName&&"PRE"==this.location[4][1].parentNode.parentNode.nodeName||"CODE"==this.location[4][1].nodeName&&"PRE"==this.location[4][1].parentNode.nodeName)?[this.location[4][1],0]:-1==this.location[4]&&0==this.location[0]?[t,0]:this.searchNode(t,l):[this.location[4][1],0]:this.searchNode(t,l),console.log(e),null===e)return null;let i=this.sel.getRangeAt(0).cloneRange();i.setStart(e[0],e[1]),i.collapse(!0),this.sel.removeAllRanges(),this.sel.addRange(i);let n=e[0].parentNode;if(n&&this.hasClass(n,"art-hide")&&(n.previousSibling&&this.hasClass(n.previousSibling,"art-text-double")?n=n.previousSibling:n.nextSibling&&this.hasClass(n.nextSibling,"art-text-double")&&(n=n.nextSibling)),n&&this.hasClass(n,"art-text-double")){let e=n.nextSibling.getAttribute("class");e=e.replace("art-hide","art-show"),n.nextSibling.setAttribute("class",e),e=n.previousSibling.getAttribute("class"),e=e.replace("art-hide","art-show"),n.previousSibling.setAttribute("class",e)}if("#text"===e[0].nodeName&&this.hasClass(e[0].parentNode,"art-hide")){let t=e[0].parentNode.getAttribute("class");t=t.replace("art-hide","art-show"),e[0].parentNode.setAttribute("class",t)}}}mdCollect(e){let t="",l="\n",i=this.rootDom.childNodes[e],n=i;if(console.log(i),this.hasClass(n,"art-tool"))return null;if("UL"===n.nodeName){l="\n";for(let e=0;e<n.childNodes.length;e++)e+1==n.childNodes.length?"\n"==n.childNodes[e].innerText?t+="* ":t+="* "+n.childNodes[e].innerText:t+="* "+n.childNodes[e].innerText+l}else if("BLOCKQUOTE"===n.nodeName){l="\n",console.log(n.childNodes.length);for(let e=0;e<n.childNodes.length;e++)if(e+1==n.childNodes.length&&(l=""),"\n"==n.childNodes[e].innerText)if(""!=l&&"\n"==n.childNodes[e+1].innerText){if(e+2==n.childNodes.length)break;t+="\n",e++}else t+="> "+l;else t+="> "+n.childNodes[e].innerText+l}else if("OL"===n.nodeName){l="\n";for(let e=0;e<n.childNodes.length;e++)e+1==n.childNodes.length?"\n"==n.childNodes[e].innerText?t+=(e+1).toString()+". ":t+=(e+1).toString()+". "+n.childNodes[e].innerText:t+=(e+1).toString()+". "+n.childNodes[e].innerText+l}else if("TABLE"===n.nodeName){let e="";for(let t=0;t<n.childNodes.length;t++){for(let l=0;l<n.childNodes[t].childNodes.length;l++)n.childNodes[t].childNodes[l].nodeName,e+="|"+n.childNodes[t].childNodes[l].innerText;t+1==n.childNodes.length?e+="|":e+="|\n"}t+=e}else{if("PRE"===n.nodeName)return null;t+=this.mdNOShieldTextCollect(i)}return t}mdNOShieldTextCollect(e){let t="";if("#text"==e.nodeName)return e.data;if(this.hasClass(e,"art-shield"))return"";for(let l=0;l<e.childNodes.length;l++)t+=this.mdNOShieldTextCollect(e.childNodes[l]);return t}getMd(){let e="";for(let t=0;t<this.rootNode.childNodes.length;t++)e+=this.rootNode.childNodes[t].getMd("read");return e}setMd(e){let t=(0,i.textToNode)(e);t&&(this.rootNode.childNodes=t),this.rootNode.render(this.rootDom),this.hljs&&(this.hljs.initHighlighting.called=!1,this.hljs.initHighlighting())}openTextarea(){this.rootDom.style.display="none",this.textarea.style.display="inline",this.textarea.value=this.getMd(),this.textarea.style.height=this.textarea.scrollHeight+"px"}closeTextarea(){this.rootDom.style.display="inline",this.setMd(this.textarea.value),this.textarea.style.display="none"}};t.default=h},function(e,t,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.css=void 0;t.css="\n.art-hide{display: inline-block;width: 0;height: 0;overflow: hidden;vertical-align: middle;}\n.art-show{color: #ccc;}\n.art-editor-html pre code{white-space: pre-wrap;}"},function(e,t,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=class{constructor(e){this.renderFlag=!0,this.md="",e.md&&(this.md=e.md),this.model="editor",e.model&&(this.model=e.model),e.katex?this.katex=e.katex:this.katex={js:"https://cdn.jsdelivr.net/npm/katex@0.10.1/dist/katex.min.js",css:"https://cdn.jsdelivr.net/npm/katex@0.10.1/dist/katex.min.css"},e.hljs?this.hljs=e.hljs:this.hljs={js:"https://libs.cdnjs.net/highlight.js/10.1.2/highlight.min.js",css:null},this.theme={backgroundColor:"#fff",color:"#1abc9c"}}};t.default=i},function(e,t,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i,n=l(7),o=(i=l(16))&&i.__esModule?i:{default:i},s=l(17);var d=class{constructor(e,t){this.artText=t,this.container=e,this.dialog=null,this.toolbar=null,this.floatAuxiliaryTool=null,this.mdHtml=null}init(){this.toolbar=document.createElement("div"),this.toolbar.style.marginBottom="25px",this.toolbar.style.padding="10px 12px",this.toolbar.style.boxShadow="0 2px 12px 0 rgba(0, 0, 0, 0.1)",this.toolbar.style.backgroundColor=this.artText.config.theme.backgroundColor,this.toolbar.setAttribute("class","art-toolbar"),(0,n.addCss)(".art-toolbar{color: #666; font-weight:600; font-size:13.5px; border-radius: 4px; position: relative;}"),this.container.insertBefore(this.toolbar,this.container.childNodes[0]),this.floatAuxiliaryTool=(0,o.default)(),this.floatAuxiliaryTool.style.backgroundColor=this.artText.config.theme.backgroundColor,(0,n.addCss)(".art-floatAuxiliaryTool-li:hover{background-color: #f0f0f0;color:"+this.artText.config.theme.color+"}"),this.container.appendChild(this.floatAuxiliaryTool),this.dialog=document.createElement("div"),this.dialog.style.position="fixed",this.dialog.style.zIndex="10",this.dialog.style.width="50%",this.dialog.style.top="6vh",this.dialog.style.backgroundColor="#fff",this.dialog.style.boxShadow="0 2px 4px rgba(0, 0, 0, .12), 0 0 6px rgba(0, 0, 0, .04)",this.dialog.style.borderRadius="2px";let e=document.createElement("div");e.style.padding="15px 20px 8px",e.style.borderBottom="1px solid #eee",e.innerHTML="md";let t=document.createElement("div");t.style.height="450px",t.style.overflow="auto",t.style.padding="5px 13px";let l=document.createElement("div");l.style.padding="15px 20px 8px";let i=document.createElement("span");i.style.cursor="pointer",i.innerHTML="关闭",i.onclick=()=>{window.artText.tool.dialog.style.display="none"},l.appendChild(i),this.dialog.appendChild(e),this.dialog.appendChild(t),this.dialog.appendChild(l),this.dialog.style.display="none",this.container.appendChild(this.dialog),this.addDefaultTool(),(0,n.addCss)(".art-toolbar-span{padding:5px 5px;margin-right: 9px} .art-toolbar-span:hover{color:#1abc9c;}")}setFloatAuxiliaryTool(e="hidden"){if("hidden"==e)return this.floatAuxiliaryTool.style.display="none",!1;this.floatAuxiliaryTool.style.display="inline";let t,l,{anchorNode:i,anchorOffset:n,focusNode:o,focusOffset:s}=e,d=i;t="#text"==d.nodeName?d.parentNode.getBoundingClientRect():d.getBoundingClientRect(),l="#text"==o.nodeName?o.parentNode.getBoundingClientRect():o.getBoundingClientRect(),this.floatAuxiliaryTool.style.top=event.pageY.toString()+"px",this.floatAuxiliaryTool.style.left=event.pageX.toString()+"px"}addDefaultTool(){this.mdHtml=this.addTool("md",()=>{"md"==this.mdHtml.innerHTML?(this.mdHtml.innerHTML="html",window.artText.interpreter.openTextarea()):(this.mdHtml.innerHTML="md",window.artText.interpreter.closeTextarea())}),this.addTool("保存本地",()=>{localStorage.md=window.artText.interpreter.getMd(),(0,s.message)("md保存成功","success")}),this.addTool("本地载入",()=>{window.artText.interpreter.setMd(localStorage.md),(0,s.message)("md载入成功","success")}),this.addTool("清空",()=>{window.artText.interpreter.setMd(""),(0,s.message)("清空成功","success")}),this.addTool('<span style="position: absolute;right: 12px;color:#1abc9c" >ATTB</span>',()=>{})}setDialog(e,t,l=""){this.dialog.style.display="block",this.dialog.childNodes[0].innerHTML=e,this.dialog.childNodes[1].appendChild(t)}addTool(e,t){let l=document.createElement("span");return l.setAttribute("class","art-toolbar-span"),l.style.cursor="pointer",l.innerHTML=e,l.onclick=t,this.toolbar.appendChild(l),l}};t.default=d},function(e,t,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){let e=document.createElement("div");e.style.width="200px",e.style.position="absolute",e.style.top="10px",e.style.left="10px",e.style.boxShadow="0 2px 12px 0 rgba(0, 0, 0, 0.1)",e.style.transition="all .15s cubic-bezier(0,0,.2,1)",e.style.border="1px solid #d1d1d1",e.style.borderRadius="2px",e.style.display="none";let t=document.createElement("ul");t.setAttribute("style","list-style:none;margin:0;padding:4px 0;font-size: 13px;font-weight: 500;");let l=document.createElement("li");l.setAttribute("class","art-floatAuxiliaryTool-li"),l.setAttribute("style","padding: 3px 20px;margin:3px 0; cursor: pointer;"),l.innerHTML="使用百度搜索",t.appendChild(l);let i=document.createElement("hr");return i.style.height="0",i.style.marginBottom="0",t.appendChild(i),l=document.createElement("li"),l.setAttribute("class","art-floatAuxiliaryTool-li"),l.setAttribute("style","padding: 3px 20px;margin:3px 0; cursor: pointer;"),l.innerText="剪切",t.appendChild(l),l=document.createElement("li"),l.setAttribute("class","art-floatAuxiliaryTool-li"),l.setAttribute("style","padding: 3px 20px;margin:3px 0; cursor: pointer;"),l.innerText="复制",t.appendChild(l),l=document.createElement("li"),l.setAttribute("class","art-floatAuxiliaryTool-li"),l.setAttribute("style","padding: 3px 20px;margin:3px 0; cursor: pointer;"),l.innerText="粘贴",t.appendChild(l),e.appendChild(t),e}},function(e,t,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.message=function(e,t="null"){let l=document.createElement("div");l.style.position="fixed",l.style.boxShadow="0 2px 12px 0 rgba(0, 0, 0, 0.1)",l.style.borderRadius="4px",l.style.left="50%",l.style.margin="-27px 0 0 -170px",l.style.position="fixed !important",l.style.top="40px",l.style.height="40px",l.style.lineHeight="40px",l.style.width="340px",l.style.padding="1px 10px 1px 15px",l.style.transition="opacity .3s,transform .4s,top .4s,-webkit-transform .4s",l.style.overflow="hidden";let i=document.createElement("p");i.innerHTML=e,i.style.fontSize="13px",i.style.fontWeight="600",i.style.height="100%",i.style.margin="0",l.appendChild(i),"info"==t?(l.style.backgroundColor="#edf2fc",l.style.borderColor="#EBEEF5",l.style.color="#909399"):"success"==t?(l.style.backgroundColor="#f0f9eb",l.style.borderColor="#e1f3d8",l.style.color="#67C23A"):"warning"==t?(l.style.backgroundColor="#fdf6ec",l.style.borderColor="#faecd8",l.style.color="#E6A23C"):"error"==t?(l.style.backgroundColor="#fef0f0",l.style.backgroundColor="#fde2e2",l.style.borderColor="#e1f3d8",l.style.color="#F56C6C"):(l.style.backgroundColor=window.artText.config.theme.backgroundColor,l.style.color="#676767");setTimeout(()=>{window.artText.container.removeChild(l)},3e3);return window.artText.container.appendChild(l),l}}]);